YUI.add("hermes-template-person",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return"data-"+u(o((s=t!=null?t.dataAttr:t)!=null?s.key:s,t))+'="'+u(o((s=t!=null?t.dataAttr:t)!=null?s.value:s,t))+'"'},3:function(e,t,n,r,i){var s;return e.escapeExpression(e.lambda((s=t!=null?t.buddyicon:t)!=null?s["default"]:s,t))},5:function(e,t,n,r,i){var s;return e.escapeExpression((s=(s=n.buddyicon||(t!=null?t.buddyicon:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"buddyicon",hash:{},data:i}):s))},7:function(e,t,n,r,i){return'	<a class="remove-person hide-text ui-icon-comment-delete" href="#">x</a>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<li class="person" '+((s=n["if"].call(u,t!=null?t.dataAttr:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n	<a class="'+l((o=(o=n.extraClasses||(t!=null?t.extraClasses:t))!=null?o:a,typeof o===f?o.call(u,{name:"extraClasses",hash:{},data:i}):o))+'" href="/photos/'+l((o=(o=n.pathAlias||(t!=null?t.pathAlias:t))!=null?o:a,typeof o===f?o.call(u,{name:"pathAlias",hash:{},data:i}):o))+'/" data-track="'+l((o=(o=n.dataTrackPrefix||(t!=null?t.dataTrackPrefix:t))!=null?o:a,typeof o===f?o.call(u,{name:"dataTrackPrefix",hash:{},data:i}):o))+'PersonIconClick">\n		<span class="person-icon">\n			<span class="circle-icon" data-person-nsid="'+l((o=(o=n.nsid||(t!=null?t.nsid:t))!=null?o:a,typeof o===f?o.call(u,{name:"nsid",hash:{},data:i}):o))+'">\n				<img src="'+((s=n["if"].call(u,(s=t!=null?t.buddyicon:t)!=null?s["default"]:s,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+'" width="'+l((o=(o=n.size||(t!=null?t.size:t))!=null?o:a,typeof o===f?o.call(u,{name:"size",hash:{},data:i}):o))+'" height="'+l((o=(o=n.size||(t!=null?t.size:t))!=null?o:a,typeof o===f?o.call(u,{name:"size",hash:{},data:i}):o))+'">\n			</span>\n			<span class="person-name">\n				'+l((n.truncate||t&&t.truncate||a).call(u,t!=null?t.displayname:t,20,{name:"truncate",hash:{},data:i}))+"\n			</span>\n		</span>\n	</a>\n"+((s=n["if"].call(u,t!=null?t.showRemove:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+"</li>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/person",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fave-menu",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{};return"	<ul>\n"+((s=n.each.call(o,t!=null?t.people:t,{name:"each",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(o,t!=null?t.moreCount:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+"	</ul>\n"},2:function(e,t,n,r,i){var s;return(s=e.invokePartial(r.person,t,{name:"person",data:i,indent:"			",helpers:n,partials:r,decorators:e.decorators}))!=null?s:""},4:function(e,t,n,r,i){var s;return"			<li class='faves-more'><a href='#'>"+e.escapeExpression((s=(s=n.moreCount||(t!=null?t.moreCount:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"moreCount",hash:{},data:i}):s))+" more</a></li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.people:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:""},usePartial:!0,useData:!0}),r={};e.Array.each(["person"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fave-menu",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-person"]});
YUI.add("flickr-photos-getFavorites-fetcher",function(e,t){"use strict";function n(t){var n;return n={photo_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||50,page:t.page||1,hermes:1},t.scrappy&&(n.sort="date_asc"),n}function r(t,n,r){var i=t[0],s=t[1],o=t[2],u;return u={id:i.photo.id,total:i.photo.total,people:[]},i.photo.person&&i.photo.person.forEach(function(t){var n=e.APIHelper.response.parsePerson(t);u.people.push(o.addOrUpdate(n))}),u.people={perPage:r.per_page,page:r.page,pageContent:u.people,totalItems:parseInt(u.total||0,10)},s.addOrUpdate(u),u.people.pageContent}function i(n,r){var i=this,s;return r.flipper.isFlipped("enable-scrappy-photo-page")&&(n.scrappy=!0),s=this._processParams(n),e.Promise.all([r.callAPI("flickr.photos.getFavorites",s,!0),r.getModelRegistry("photo-people-who-faved-models"),r.getModelRegistry("person-models")]).then(function(e){return i._processResponse(e,n,s)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photos-getFavorites"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-people-who-faved-models","person-models"]});
YUI.add("photo-people-who-faved-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photos-getFavorites"].run(t,this.appContext)}},attributes:{total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},people:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photos-getFavorites"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getFavorites-fetcher"]});
YUI.add("sub-photo-fave-view",function(e){var t=50,n=30,r=750,i="whoFaved";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this,n=this.appContext.getViewer(),r=[];return r.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){t.set("photo",e)})),r.push(this.appContext.getModel("photo-engagement-models",this.photoId).then(function(e){t.set("photo-engagement",e)})),r.push(this.appContext.getModel("photo-people-who-faved-models",this.photoId).then(function(e){t.set("photo-people-who-faved-model",e)})),n.signedIn&&t.appContext.getModel("person-models",n.nsid).then(function(e){t.set("viewer-person-model",e)}),e.Promise.all(r)},buildContainer:function(){var e=this.get("photo-people-who-faved-model"),n=e.toJSON().total,r;return n===0?(this.setContainerHTML(""),this.get("container").removeClass("faves-present")):(r=e.getValue("people").toJSON(),r.forEach(function(e){e.pathAlias+="/favorites"}),this.setContainerWithTemplate("sub-photo-faved-by",{people:r,totalPeopleFaved:n,remainingFavedBy:n-2,isFaved:this.get("photo-engagement").getValue("isFaved"),viewerIsOwner:this.get("photo").getValue("owner").getValue("isMe")}),this.get("container").addClass("faves-present"),YUI.Env.isServer||(!this.processingFave&&this.get("photo-people-who-faved-model").getValue("total")>0&&this.buildWhoFavedTooltip(),this.get("container").show(),this.get("photo-people-who-faved-model").getValue("total")>t&&this.setUpFaveTooltipPagination())),this},activate:function(){var t=this,n=this.get("container");return this.registerEventHandler(n.delegate("click",this.faveCountClicked,"a.remaining-faved-by",t)),n.one(".faved-by")||n.setStyle("display","none"),n.one("a.ui-icon-fave-star")&&this.registerEventHandler(n.delegate("click",this.handleFaveClick,"a.ui-icon-fave-star",this)),this.get("photo-engagement")&&this.registerEventHandler(this.get("photo-engagement").on("valuesChanged",function(n){if(typeof n["faveCount"]=="undefined")return;t.get("photo-engagement").getValue("isFaved")?t.get("photo-engagement").getValue("faveCount")<=t.get("photo-people-who-faved-model").getValue("people").getList().length+1&&t.get("photo-people-who-faved-model").getValue("people").appendToList(t.get("viewer-person-model")):t.get("photo-people-who-faved-model").getValue("people").removeFromList(t.appContext.getViewer().nsid),t.get("photo-people-who-faved-model").setValue("total",t.get("photo-engagement").getValue("faveCount")),t.get("photo-engagement").remoteUpdate().then(function(){t.processingFave=!1,t.buildContainer()},function(n){t.processingFave=!1;if(n.code!==3){t.get("photo-people-who-faved-model").revertValue("people"),t.get("photo-people-who-faved-model").revertValue("total"),t.get("photo-engagement").registry.toggleFave(t.photoId),t.buildContainer();var r=new e.Views.FluidModal({title:t.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:t.intlMessage({intlName:"common.OK"}),htmlMessage:t.intlMessage({intlName:"fave-view.COULDNT_FAVE"}),appContext:t.appContext,classList:"scrappy-dialog",dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0});r.show()}})})),this},faveCountClicked:function(t,n){t.preventDefault(),this.favedTooltip&&this.get("photo-engagement").getValue("faveCount")&&(this.favedTooltip.toggle(),e.rapidTracker.beacon(this.name,"faveCountActionBarButtonClick")),this.positionTooltip()},positionTooltip:function(){var e,t,n=this.get("container").one("a.remaining-faved-by").getDOMNode();t=n.getBoundingClientRect(),e=this.get("container").one("a.remaining-faved-by").getXY(),t.left-t.width+48<0?this.get("container").one(".dialog-tooltip").setStyle("left",t.left):this.get("container").one(".dialog-tooltip").setStyle("left",t.left-t.width+48),this.get("container").one(".dialog-tooltip").setStyle("top",e[1]+30)},favedTooltipScroll:function(s){var o,u,a,f,l=this;o=this.favedTooltipWrapper.getDOMNode().scrollTop;if(o>this.pageVals.bottomOfCurrentFavePage-r)return u=this.favedTooltipWrapper.one(".faves-more"),u.set("text",this.intlMessage({intlName:"common.LOADING"})),f=this.get("photo-people-who-faved-model").getValue("people").getPage({page:++this.pageVals.currentFavePage,perPage:t}).then(function(r){var s="",o;u.remove(),r.forEach(function(e){e=e.toJSON(),e.size=n,e.pathAlias+="/favorites",e.dataTrackPrefix=i,s+=l.templates("person")(e)}),a=l.favedTooltipWrapper.one("ul"),a.append(s),l.pageVals.currentFavePage<l.pageVals.numFavePages&&(l.pageVals.bottomOfCurrentFavePage+=l.pageVals.lineHeight*r.length,l.favedTooltipScrollWatcher=e.config.win.requestAnimationFrame(l.favedTooltipScroll.bind(l)),o=l.get("photo-people-who-faved-model").getValue("total")-l.pageVals.currentFavePage*t,u.set("text",o+" more"),a.append(u))}),f;this.pageVals.currentFavePage<this.pageVals.numFavePages&&(this.favedTooltipScrollWatcher=window.requestAnimationFrame(this.favedTooltipScroll.bind(this)))},buildWhoFavedTooltip:function(){var r=this.get("container"),s=this.get("photo-people-who-faved-model"),o,u,a=this,f,l;u=s.getValue("people").toJSON(),u.forEach(function(e){e.size=n,e.pathAlias+="/favorites",e.dataTrackPrefix=i}),u.splice(0,2),f=Math.ceil(s.getValue("people").getList().length/t),l=Math.max(0,s.getValue("total")-f*t),o=this.templates("fave-menu")({people:u,moreCount:l}),e.use("dialog",function(){a.favedTooltip=e.Views.dialog.getNewInstance("dialog-tooltip",{content:o,anchorTo:r,parent:a,positioning:!1,rootEl:r}),a.favedTooltip.render(),a.favedTooltip.get("container").removeAttribute("data-action")})},setUpFaveTooltipPagination:function(){var e=this.get("container"),n,r=this.get("photo-people-who-faved-model"),i=this;this.pageVals={numFavePages:0,currentFavePage:0,lineHeight:0,bottomOfCurrentFavePage:0},this.pageVals.numFavePages=Math.ceil(r.getValue("total")/t);if(this
.pageVals.numFavePages<=1)return;this.pageVals.currentFavePage=Math.ceil(r.getValue("people").getList().length/t),this.pageVals.currentFavePage=Math.max(1,this.pageVals.currentFavePage),this.favedTooltipWrapper=e.one(".ui-dialog-wrapper"),e.one(".dialog-tooltip").setStyle("visibility","hidden"),e.one(".dialog-tooltip").removeClass("ui-util-removed"),n=this.favedTooltipWrapper.one("li").get("clientHeight"),this.pageVals.lineHeight=this.favedTooltipWrapper.one("li:nth-child(2)").get("clientHeight"),this.pageVals.bottomOfCurrentFavePage=n+(t-1)*this.pageVals.lineHeight-this.favedTooltipWrapper.get("clientHeight"),this.pageVals.bottomOfCurrentFavePage+=(this.pageVals.currentFavePage-1)*t*this.pageVals.lineHeight,e.one(".dialog-tooltip").setStyle("visibility","visible"),e.one(".dialog-tooltip").addClass("ui-util-removed"),this.favedTooltip&&this.registerEventHandler(this.favedTooltip.on("show",function(e){i.favedTooltipScrollWatcher=window.requestAnimationFrame(i.favedTooltipScroll.bind(i)),i.favedTooltip.on(["dismiss","hide","destroy"],function(e){i.favedTooltipScrollWatcher&&(window.cancelAnimationFrame(i.favedTooltipScrollWatcher),delete i.favedTooltipScrollWatcher),i.favedTooltip.detach("dismiss"),i.favedTooltip.detach("hide"),i.favedTooltip.detach("destroy")})}))},handleFaveClick:function(t){t.preventDefault();if(this.processingFave)return;this.appContext.getViewer().signedIn?(this.processingFave=!0,this.get("photo-engagement").registry.toggleFave(this.photoId),this.buildContainer(),this.buildWhoFavedTooltip(),e.rapidTracker.beacon(this.name,"faveStarFaveListClick")):this.signedOutFaveAttemptDialog()},signedOutFaveAttemptDialog:function(){var t=this,n;n=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),htmlMessage:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_MESSAGE"}),actionButtonLabel:this.intlMessage({intlName:"fave-view.SIGN_IN_AND_FAVE"}),cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})}),n.on("actionClick",function(){e.SigninHelper.addPendingFave({id:t.photoId})}),n.show()}})},"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-faved-by","signin-helper","hermes-template-fave-menu","hermes-template-person","animation-manager"],optional:["photo-engagement-models","photo-people-who-faved-models","person-models"],langBundles:["common","photo-page-scrappy","fave-view"]});
YUI.add("hermes-lang-fave-view",function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:["We couldn't fave at this time"],SIGN_IN_TO_FAVE:["You must be signed in to fave. Please sign in now."],LOADING_FAVES:["Loading Faves..."],UNFAVE_PHOTO:["Unfave this photo"],FAVE_PHOTO:["Fave this photo"],WHO_FAVED:["Who faved this photo"],SIGN_IN_BEFORE_FAVE_TITLE:["You found a photo to fave!"],SIGN_IN_BEFORE_FAVE_MESSAGE:["That's great. Just sign in to fave it."],SIGN_IN_AND_FAVE:["Sign in and fave"],JOIN_FLICKR_AND_FAVE:["Join Flickr to add this photo to your favorites."]})},"@VERSION@",{requires:["intl"]});
YUI.add("sub-photo-left-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.backToURL=e.backToURL,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"sub-photo-title-desc-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,additionalViewClasses:["clear-float","photo-attribution"]},"sub-photo-comments-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,includePermalink:!0},"sub-photo-fave-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){return this.setContainerWithTemplate("sub-photo-left"),this},buildErrorContainer:function(){},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-left","url-helper"],optional:["attribution-view","sub-photo-title-desc-view","photo-license-view","sub-photo-comments-view","sub-photo-fave-view"]});
YUI.add("hermes-template-sub-photo-right",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'<div class="sub-photo-right-row1">\n    '+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-right-stats-view"]:t,{name:"outlet",hash:{},data:i}))+"\n    "+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-date-view"]:t,{name:"outlet",hash:{},data:i}))+"\n    "+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["photo-license-view"]:t,{name:"outlet",hash:{},data:i}))+'\n    <div style="clear: both;"></div>\n</div>\n\n'+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["photo-charm-exif-scrappy-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-contexts-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-tags-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-additional-info-view"]:t,{name:"outlet",hash:{},data:i}))},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-right",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dropdown",function(e){"use strict";var t,n;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected",hasDialogArrow:"ui-dropdown-has-dialog-arrow",dialogArrow:"ui-dialog-arrow",useCheckMarks:"ui-dropdown-use-checkboxes"},options:{hasDialogArrow:!1,useCheckMarks:!1}},e.namespace("Views").Dropdown=n=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this,r=this.get("container"),i;this.close(),this._items={},e.Lang.isArray(this.get("selected"))||this.set("selected",[this.get("selected")]),r.all(t.css.items).each(function(e){var t=e.getData();n._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',sub:t.sub,node:e}}),this.labelEl=r.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),r.insert(this.labelEl,0)),i=this.get("staticLabel")||this.get("defaultLabel"),i&&(i===!0?this.labelEl.set("text","set staticLabel/defaultLabel to a string, not `true`"):this.labelEl.set("text",i)),this.get("hasDialogArrow")&&!r.hasClass(t.css.hasDialogArrow)&&r.addClass(t.css.hasDialogArrow),r.hasClass(t.css.hasDialogArrow)&&(this.dialogArrowEl=r.one(t.css.dialogArrow),this.dialogArrowEl||(this.dialogArrowEl=e.Node.create('<span class="ui-dialog-arrow" />'),r.insert(this.dialogArrowEl,1))),this.get("useCheckMarks")&&!r.hasClass(t.css.useCheckMarks)&&r.addClass(t.css.useCheckMarks),this.select();if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":function(t,r){t.halt();if(!n.get("multiSelect")&&!n.get("multiSelectSub")&&e.Array.indexOf(n.get("selected"),r.value)>=0)return n.close();n.select(r.value,r)}})},select:function(n,r,i){var s=this,o=n?this._items[n]:null,u=!0,a=[],f;o&&e.Array.indexOf(this.get("selected"),n)>=0&&(this.get("multiSelect")||this.get("multiSelectSub"))?(a=this.get("selected"),!o.sub&&this.get("multiSelect")&&a.length>this.get("minimumSelected")?(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1):o.sub&&(a.splice(e.Array.indexOf(this.get("selected"),n),1),u=!1),this.set("selected",a)):o&&(o.sub?(a.push(n),this.get("selectParent")&&a.push(o.sub),e.Array.each(this.get("selected"),function(e){s._items[e].sub===o.sub?a.push(e):s.get("multiSelect")&&!s._items[e].sub&&a.push(e)})):this.get("multiSelect")?(a=this.get("selected"),a.push(n)):a.push(n),this.set("selected",a)),i||this.close(),f={clicked:o?{text:o.text,value:n,sub:o.sub,itemEl:o.node,isChecked:u}:null,data:r,selections:a},this.fire("selected",f),this.update(n,f,t)},update:function(t,n,r){var i=this,s=n.clicked,o=this.get("selected"),u=this.get("defaultLabel")||"[Unable to select a default item]";this.get("staticLabel")||(this.get("labelFunction")?u=this.get("labelFunction").apply(this,[t]):s?n.data&&n.data.text&&n.data.text!==s.text?u=n.data.text:u=s.text:o.length>0&&i._items[o[0]]&&(u=i._items[o[0]].text),this.labelEl.set("textContent",u||"[!empty data-text!]")),this.get("container").all(r.css.items).removeClass(r.css.itemSelected),e.Array.each(o,function(e){i._items[e]&&i._items[e].node.addClass(r.css.itemSelected)})},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){var n=this.get("container"),r=0,i=0,s=30;this._open=!0,this.get("shouldCreateShim")&&this._shimUp(),n.removeClass(t.css.closed),this.get("autoSizeMenu")&&(r=parseInt(this.labelEl.getComputedStyle("width"),10),i=parseInt(n.one("ul").getComputedStyle("width"),10),r+s>i&&n.one("ul").setStyles({width:r+s})),(!e||!e.silent)&&this.fire("open",e)},close:function(e){e&&e.halt(),this._open=!1,this._shimUp(!1),this.fire("close",e),this.get("container").addClass(t.css.closed)},_shimUp:function(n){if(n===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div />"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){var e=this.get("container");this.set("disabled",!0),this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this._items=null,this.labelEl=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:[]},disabled:{value:!1},hasDialogArrow:{value:!1},useCheckMarks:{value:!1},multiSelect:{value:!1},multiSelectSub:{value:!1},selectParent:{value:!0},minimumSelected:{value:0},staticLabel:{value:!1},defaultLabel:{value:!1},labelFunction:function(){},shouldCreateShim:{value:!0},autoSizeMenu:{value:!0}}})},"@VERSION@",{requires:["flickr-view"]});
YUI.add("exif-camera-map",function(e){"use strict";e.ExifCameraMap={cameraTypesMap:{"Digital SLR":{fileName:"CanonEOSRebelXT"},"Point and Shoot":{fileName:"CanonPowerShotSD100"},Cameraphone:{fileName:"SamsungGalaxySII"},"Video Camera":{fileName:"SonyCyberShotDSCF828"},"Digital Back":{fileName:"generic"},"Digital Rangefinder":{fileName:"generic"},"Film Camera":{fileName:"Lomo"},"Mirrorless Camera":{fileName:"PanasonicLumixGF1"}},cameraMap:{iPhone:{pattern:/iphone/i,fileName:"iPhone5s"},canonEOS5D:{pattern:/Canon EOS(\-1D| 5D)/i,fileName:"CanonEOSMarkII"},canonEOS10D:{pattern:/canon EOS 10D/i,fileName:"CanonEOS10D"},canonEOS60D:{pattern:/canon EOS 60D/i,fileName:"CanonEOS60D"},canonEOSDigitalRebel:{pattern:/Canon EOS (REBEL T3i|600D|Kiss X5)/i,fileName:"CanonEOSRebelXT"},canonPowerShotA510:{pattern:/Canon PowerShot A510/i,fileName:"CanonPowerShotA510"},canonPowerShotSD100:{pattern:/Canon PowerShot SD100/i,fileName:"CanonPowerShotSD100"},canonPowerShotSD750:{pattern:/Canon PowerShot SD750/i,fileName:"CanonPowerShotSD750"},canonPowershotG9:{pattern:/Canon Powershot G9/i,fileName:"CanonPowershotG9"},canonPowershotN:{pattern:/Canon Powershot N/i,fileName:"CanonPowershotN"},htcEvo4G:{pattern:/HTC EVO 4G/i,fileName:"HTCEVO4G"},htcOne:{pattern:/HTC One/i,fileName:"HTCOne"},htcGeneric:{pattern:/htc/i,fileName:"HTCOne"},goPro:{pattern:/gopro/i,fileName:"GoProHero3"},kodakEasyShareZ740Zoom:{pattern:/kodak EasyShare Z740 Zoom/i,fileName:"KodakEasyShareZ740Zoom"},leica:{pattern:/Leica|Zeiss/i,fileName:"Leica"},lomo:{pattern:/Lomo/i,fileName:"Lomo"},lytro:{pattern:/Lytro/i,fileName:"Lytro"},motorolaX:{pattern:/Motorola X/i,fileName:"MotorolaX"},nexus5:{pattern:/Nexus 5|LGE Nexus 4/i,fileName:"Nexus5"},nikonCoolPix4600:{pattern:/Nikon CoolPix/i,fileName:"NikonCoolPix4600"},nikonDF:{pattern:/Nikon DF/i,fileName:"NikonDF"},nikonD100:{pattern:/Nikon D/i,fileName:"NikonD100"},olympusEVOLTE500:{pattern:/Olympus EVOLTE 500/i,fileName:"OlympusEVOLTE500"},panasonicDMCFZ18:{pattern:/Panasonic DMC\-FZ18/i,fileName:"PanasonicDMC-FZ18"},panasonicLumixGF1:{pattern:/Panasonic DMC-GF1/i,fileName:"PanasonicLumixGF1"},pentaxK100D:{pattern:/Pentax K100D/i,fileName:"PentaxK100D"},polaroid:{pattern:/Polaroid/i,fileName:"Polaroid"},samsungGalaxySII:{pattern:/SamsungGalaxySII$/i,fileName:"SamsungGalaxySII"},samsungGalaxySIII:{pattern:/SamsungGalaxySIII$/i,fileName:"SamsungGalaxySII"},sonyA7:{pattern:/Sony A7|ILCE-7/i,fileName:"SonyA7"},sonyAlphaDSLRA100:{pattern:/Sony Alpha DSLR\-A100/i,fileName:"SonyAlphaDSLR-A100"},sonyCyberShotDSCW80:{pattern:/Sony CyberShot DSC\-W80/i,fileName:"SonyCyber-ShotDSC-W80"},sonyCyberShotDSCF828:{pattern:/Sony CyberShot DSCF828|Sony DSC-F828/i,fileName:"SonyCyberShotDSCF828"},sonyEricsonK750i:{pattern:/Sony Ericson K750i/i,fileName:"SonyEricsonK750i"},sonyEricsonK800i:{pattern:/Sony Ericson K800i|K800i/i,fileName:"SonyEricsonK800i"},sonyNEX5:{pattern:/Sony NEX\-[56]/i,fileName:"SonyNEX-5"},sonyRX:{pattern:/SonyRX|Sony DSC-RX100/i,fileName:"SonyRX"}},lensTypeCSS:{large:"lens-lrg",medium:"lens-med",small:"lens-small",phone:"lens-phone"},identifyLens:function(e,t){var n=null;return t&&t.match(/cameraphone/i)&&(n=this.lensTypeCSS.phone),!n&&e&&(e.match(/(55\-250)|(70\-200)|(300|400|500|600|800)/)?n=this.lensTypeCSS.large:e.match(/(\-(55|70|85|105|135|200))|(135)/)&&(n=this.lensTypeCSS.medium)),!n&&(t||e)&&(n=this.lensTypeCSS.small),{className:n}},identifyCamera:function(t,n){var r,i;return t?(r=this.cameraMap,e.Object.some(r,function(e){if(e.pattern.test(t))return i=e,!0}),i||!i&&this.cameraTypesMap&&n&&this.cameraTypesMap[n]&&(i=this.cameraTypesMap[n]),i||(i={fileName:"generic"}),i):i},getCameraImageURL:function(t,n,r){var i,s,o,u;return o=null,i=this.identifyCamera(t,n),i&&i.fileName&&(u=e.config.flickr.urls&&e.config.flickr.urls.assetRoot?e.config.flickr.urls.assetRoot||"":"",o=u+"/images/scrappy-camera-icons/"+i.fileName+(r&&r.getCookie("density")>1?"@2x.png":".png"),s={url:o}),s}}},"@VERSION@");
YUI.add("hermes-template-photo-charm-exif-scrappy",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{};return'				<!-- camera only -->\n				<li class="c-charm-item-camera'+((s=n["if"].call(o,(s=t!=null?t.cameraData:t)!=null?s.url:s,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+' divided-bottom">\n					<div class="exif-row">\n						<div class="exif-item">\n'+((s=n["if"].call(o,t!=null?t.cameraData:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.program(7,i,0),data:i}))!=null?s:"")+'						</div>\n\n						<div class="exif-item c-charm-item-lens full-width">\n							<div class="exif-camera-name">\n'+((s=n["if"].call(o,(s=t!=null?t.exif:t)!=null?s.cameraURL:s,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.program(11,i,0),data:i}))!=null?s:"")+'							</div>\n							<div class="exif-row">\n								<div class="exif-item full-width">\n									<div class="lens-string">'+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.lensModel:s,t))+"</div>\n								</div>\n							</div>\n					   </div>\n					</div>\n				</li>\n"},2:function(e,t,n,r,i){return" identified-camera"},4:function(e,t,n,r,i){var s;return'							<span class="ui-illustration-camera" title="'+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.camera:s,t))+'" '+((s=n.unless.call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"unless",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+"></span>\n"},5:function(e,t,n,r,i){var s;return'style="background-image:url('+e.escapeExpression((s=(s=n.cameraData||(t!=null?t.cameraData:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"cameraData",hash:{},data:i}):s))+')"'},7:function(e,t,n,r,i){return'							<i class="ui-icon-camera"></i>\n'},9:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return"									<a href="+u(o((s=t!=null?t.exif:t)!=null?s.cameraURL:s,t))+">\n										"+u(o((s=t!=null?t.exif:t)!=null?s.camera:s,t))+"\n									</a>\n"},11:function(e,t,n,r,i){var s;return"									"+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.camera:s,t))+"\n"},13:function(e,t,n,r,i){var s;return'					<li class="c-charm-item-aperture two-up">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.program(16,i,0),data:i}))!=null?s:"")+"						<span>\u0192/"+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.fNumber:s,t))+"</span>\n					</li>\n"},14:function(e,t,n,r,i){return'							<svg class="icon icon-aperture"><use xlink:href="#icon-aperture"></use></svg>\n'},16:function(e,t,n,r,i){return'							<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.APERTURE"},data:i}))+'" class="ui-icon-tiny-aperture"></i>\n'},18:function(e,t,n,r,i){var s;return'					<li class="c-charm-item-focal-length two-up">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(19,i,0),inverse:e.program(21,i,0),data:i}))!=null?s:"")+"						<span>"+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.focalLength:s,t))+"</span>\n					</li>\n"},19:function(e,t,n,r,i){return'							<svg class="icon icon-focal_length"><use xlink:href="#icon-focal_length"></use></svg>\n'},21:function(e,t,n,r,i){return'							<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FOCAL_LENGTH"},data:i}))+'" class="ui-icon-tiny-focal-length"></i>\n'},23:function(e,t,n,r,i){var s;return'					<li class="c-charm-item-exposure-time two-up">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(24,i,0),inverse:e.program(26,i,0),data:i}))!=null?s:"")+"						<span>"+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.exposureTime:s,t))+"</span>\n					</li>\n"},24:function(e,t,n,r,i){return'							<svg class="icon icon-shutter_speed"><use xlink:href="#icon-shutter_speed"></use></svg>\n'},26:function(e,t,n,r,i){return'							<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.EXPOSURE_TIME"},data:i}))+'" class="ui-icon-tiny-exposure-time"></i>\n'},28:function(e,t,n,r,i){var s;return'					<li class="c-charm-item-iso two-up">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(29,i,0),inverse:e.program(31,i,0),data:i}))!=null?s:"")+"						<span>"+e.escapeExpression(e.lambda((s=t!=null?t.exif:t)!=null?s.iso:s,t))+"</span>\n					</li>\n"},29:function(e,t,n,r,i){return'							<svg class="icon icon-ISO"><use xlink:href="#icon-ISO"></use></svg>\n'},31:function(e,t,n,r,i){return'							<i title="ISO" class="ui-icon-tiny-iso"></i>\n'},33:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing;return'\n					<li class="c-charm-item-flash two-up">\n\n'+((s=n["if"].call(u,(s=t!=null?t.exif:t)!=null?s.flashModeAuto:s,{name:"if",hash:{},fn:e.program(34,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(u,(s=t!=null?t.exif:t)!=null?s.flashModeOn:s,{name:"if",hash:{},fn:e.program(45,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(u,(s=t!=null?t.exif:t)!=null?s.flashModeOff:s,{name:"if",hash:{},fn:e.program(54,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.exif:t)!=null?s.flash:s,"===","Fired",{name:"ifCond",hash:{},fn:e.program(59,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n						<span>"+e.escapeExpression((o=(o=n.flashString||(t!=null?t.flashString:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"flashString",hash:{},data:i}):o))+"</span>\n\n					</li>\n\n"},34:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.exif:t)!=null?s.flashFired:s,{name:"if",hash:{},fn:e.program(35,i,0),inverse:e.program(40,i,0),data:i}))!=null?s:""},35:function(e,t,n,r,i){var s;return(
s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(36,i,0),inverse:e.program(38,i,0),data:i}))!=null?s:""},36:function(e,t,n,r,i){return'									<svg class="icon icon-flash_auto"><use xlink:href="#icon-flash_auto"></use></svg>\n'},38:function(e,t,n,r,i){return'									<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_AUTO_FIRED"},data:i}))+'" class="ui-icon-tiny-flash-auto"></i>\n'},40:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(41,i,0),inverse:e.program(43,i,0),data:i}))!=null?s:""},41:function(e,t,n,r,i){return'									<svg class="icon icon-flash_off"><use xlink:href="#icon-flash_off"></use></svg>\n'},43:function(e,t,n,r,i){return'									<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_AUTO_NO_FIRE"},data:i}))+'" class="ui-icon-tiny-flash-auto"></i>\n'},45:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.exif:t)!=null?s.flashFired:s,{name:"if",hash:{},fn:e.program(46,i,0),inverse:e.program(51,i,0),data:i}))!=null?s:""},46:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(47,i,0),inverse:e.program(49,i,0),data:i}))!=null?s:""},47:function(e,t,n,r,i){return'									<svg class="icon icon-flash_on"><use xlink:href="#icon-flash_on"></use></svg>\n'},49:function(e,t,n,r,i){return'									<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_ON_FIRED"},data:i}))+'" class="ui-icon-tiny-flash-on"></i>\n'},51:function(e,t,n,r,i){var s;return'								<!-- yes, apparently flash can be "on" but not actually fire, per EXIF. -->\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(41,i,0),inverse:e.program(52,i,0),data:i}))!=null?s:"")},52:function(e,t,n,r,i){return'									<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_ON_NO_FIRE"},data:i}))+'" class="ui-icon-tiny-flash-on"></i>\n'},54:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(55,i,0),inverse:e.program(57,i,0),data:i}))!=null?s:""},55:function(e,t,n,r,i){return'								<svg class="icon icon-flash_off"><use xlink:href="#icon-flash_off"></use></svg>\n'},57:function(e,t,n,r,i){return'								<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_OFF"},data:i}))+'" class="ui-icon-tiny-flash-off"></i>\n'},59:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(60,i,0),inverse:e.program(62,i,0),data:i}))!=null?s:""},60:function(e,t,n,r,i){return'								<svg class="icon icon-flash_on"><use xlink:href="#icon-flash_on"></use></svg>\n'},62:function(e,t,n,r,i){return'								<i title="'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FLASH_ON_FIRED"},data:i}))+'" class="ui-icon-tiny-flash-on"></i>\n'},64:function(e,t,n,r,i,s,o){var u,a=t!=null?t:{};return"\n"+((u=n["if"].call(a,t!=null?t.exifInfoIsPresent:t,{name:"if",hash:{},fn:e.program(65,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n					<!-- Extended Exif -->\n\n"+((u=n.unless.call(a,t!=null?t.exifInfoIsPresent:t,{name:"unless",hash:{},fn:e.program(76,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"},65:function(e,t,n,r,i,s,o){var u;return(u=n["if"].call(t!=null?t:{},t!=null?t.exif:t,{name:"if",hash:{},fn:e.program(66,i,0,s,o),inverse:e.noop,data:i}))!=null?u:""},66:function(e,t,n,r,i,s,o){var u,a=t!=null?t:{};return'							<li class="extended-exif two-up">\n'+((u=n["if"].call(a,t!=null?t.showExpanded:t,{name:"if",hash:{},fn:e.program(67,i,0,s,o),inverse:e.program(69,i,0,s,o),data:i}))!=null?u:"")+"							</li>\n"+((u=n.each.call(a,t!=null?t.extendedExif:t,{name:"each",hash:{},fn:e.program(71,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")},67:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'									<i title="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.HIDE_EXIF"},data:i}))+'" class="ui-icon-tiny-exif"></i>\n									<a href="#" class="show-extended-exif hide-moreExif">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.HIDE_EXIF"},data:i}))+" </a>\n"},69:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'									<i title="'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_EXIF"},data:i}))+'" class="ui-icon-tiny-exif"></i>\n									<a href="#" class="show-extended-exif">'+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_EXIF"},data:i}))+" </a>\n"},71:function(e,t,n,r,i,s,o){var u,a,f=t!=null?t:{},l=n.helperMissing,c="function",h=e.escapeExpression;return((u=n["if"].call(f,o[1]!=null?o[1].showExpanded:o[1],{name:"if",hash:{},fn:e.program(72,i,0,s,o),inverse:e.program(74,i,0,s,o),data:i}))!=null?u:"")+'									<span class="exif-name">'+h((a=(a=n.label||(t!=null?t.label:t))!=null?a:l,typeof a===c?a.call(f,{name:"label",hash:{},data:i}):a))+' - </span>\n									<span class="exif-value">'+h((a=(a=n.value||(t!=null?t.value:t))!=null?a:l,typeof a===c?a.call(f,{name:"value",hash:{},data:i}):a))+"</span>\n								</li>\n"},72:function(e,t,n,r,i){return'									<li class="extended-exif-item">\n'},74:function(
e,t,n,r,i){return'									<li class="extended-exif-item" style="display: none;">\n'},76:function(e,t,n,r,i,s,o){var u;return(u=n["if"].call(t!=null?t:{},(u=(u=t!=null?t.exif:t)!=null?u.data:u)!=null?u.length:u,{name:"if",hash:{},fn:e.program(77,i,0,s,o),inverse:e.noop,data:i}))!=null?u:""},77:function(e,t,n,r,i,s,o){var u,a=t!=null?t:{},f=n.helperMissing,l=e.escapeExpression;return'							<li class="extended-exif">\n									<i title="'+l((n.intlMessage||t&&t.intlMessage||f).call(a,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_EXIF"},data:i}))+'" class="ui-icon-tiny-exif"></i>\n									<a href="#" class="show-extended-exif">'+l((n.intlMessage||t&&t.intlMessage||f).call(a,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_EXIF"},data:i}))+"</a>\n							</li>\n"+((u=n.each.call(a,t!=null?t.extendedExif:t,{name:"each",hash:{},fn:e.program(78,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")},78:function(e,t,n,r,i,s,o){var u,a,f=t!=null?t:{},l=n.helperMissing,c="function",h=e.escapeExpression;return((u=n["if"].call(f,o[1]!=null?o[1].showExpanded:o[1],{name:"if",hash:{},fn:e.program(72,i,0,s,o),inverse:e.program(74,i,0,s,o),data:i}))!=null?u:"")+'										<span class="exif-name">'+h((a=(a=n.label||(t!=null?t.label:t))!=null?a:l,typeof a===c?a.call(f,{name:"label",hash:{},data:i}):a))+' - </span>\n										<span class="exif-value">'+h((a=(a=n.value||(t!=null?t.value:t))!=null?a:l,typeof a===c?a.call(f,{name:"value",hash:{},data:i}):a))+"</span>\n									</li>\n"},80:function(e,t,n,r,i){var s;return'		<div class="exif-column-2">\n			<li class="c-charm-date">\n				<!-- On mobile we want to include the date taken -->\n				<svg class="icon icon-date"><use xlink:href="#icon-date"></use></svg>\n\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isDateTakenUnknown:t,{name:"if",hash:{},fn:e.program(81,i,0),inverse:e.program(86,i,0),data:i}))!=null?s:"")+"			</li>\n		</div>\n"},81:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing;return'					<span class="date-taken-label" title="'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||u).call(o,t!=null?t.datePosted:t,false,false,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(82,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||u).call(o,t!=null?t.datePosted:t,false,false,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(84,i,0),inverse:e.noop,data:i}))!=null?s:"")+"					</span>\n"},82:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlDate:t!=null?t.intlDate:t,intlName:t!=null?t.intlName:t},data:i}))},84:function(e,t,n,r,i){return"							"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlDate:t!=null?t.intlDate:t,intlName:t!=null?t.intlName:t},data:i}))+"\n"},86:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing;return'					<span class="date-taken-label" title="'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||u).call(o,t!=null?t.datePosted:t,false,false,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(82,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||u).call(o,t!=null?t.dateTaken:t,t!=null?t.takenGranularity:t,true,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(84,i,0),inverse:e.noop,data:i}))!=null?s:"")+"					</span>\n"},88:function(e,t,n,r,i){var s,o=t!=null?t:{};return'				<li class="c-charm-item-location">\n\n'+((s=n.unless.call(o,t!=null?t.isMobileExif:t,{name:"unless",hash:{},fn:e.program(89,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.showEditLocation:t,{name:"if",hash:{},fn:e.program(93,i,0),inverse:e.program(95,i,0),data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(97,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.isFoursquare:t,{name:"if",hash:{},fn:e.program(99,i,0),inverse:e.program(102,i,0),data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(111,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n				</div>\n				</li>\n"},89:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.location:t)!=null?s.staticMaps:s,{name:"if",hash:{},fn:e.program(90,i,0),inverse:e.noop,data:i}))!=null?s:""},90:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s,{name:"if",hash:{},fn:e.program(91,i,0),inverse:e.noop,data:i}))!=null?s:""},91:function(e,t,n,r,i){var s,o,u=e.escapeExpression,a=e.lambda;return'							<div class="map-container">\n								<a class="static-maps" href='+u((o=(o=n.linkToMap||(t!=null?t.linkToMap:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(t!=null?t:{},{name:"linkToMap",hash:{},data:i}):o))+'>\n									<span class="static-map-attribution"></span>\n									<span class="bullseye"></span>\n									<span class="zoom zoom3" style="background-image: url('+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.src:s,t))+") 1x, url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n									<span class="zoom zoom6" style="background-image: url('+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.src:s,t))+") 1x, url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n									<span class="zoom zoom14" style="background-image: url('+
u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.src:s,t))+") 1x, url("+u(a((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n								</a>\n							</div>\n'},93:function(e,t,n,r,i){return'			   		<div class="location-data-container editable">\n'},95:function(e,t,n,r,i){return'			   		<div class="location-data-container">\n'},97:function(e,t,n,r,i){return'					<div class="location-icon">\n						<svg class="icon icon-location"><use xlink:href="#icon-location"></use></svg>\n					</div>\n'},99:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'\n					<a class="foursquare-on-flickr-search location-name-link" href="/search/?foursquare_venueid='+l((o=(o=n.fourSquarePlaceId||(t!=null?t.fourSquarePlaceId:t))!=null?o:a,typeof o===f?o.call(u,{name:"fourSquarePlaceId",hash:{},data:i}):o))+'">\n						'+l((o=(o=n.locationText||(t!=null?t.locationText:t))!=null?o:a,typeof o===f?o.call(u,{name:"locationText",hash:{},data:i}):o))+"\n					</a>\n					"+((s=n["if"].call(u,t!=null?t.showEditLocation:t,{name:"if",hash:{},fn:e.program(100,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n					<a class="foursquare-venue" href="https://foursquare.com/venue/'+l((o=(o=n.fourSquarePlaceId||(t!=null?t.fourSquarePlaceId:t))!=null?o:a,typeof o===f?o.call(u,{name:"fourSquarePlaceId",hash:{},data:i}):o))+'" target="_newtab">\n						'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.POWERED_BY"},data:i}))+'<i title="Location" class="location ui-icon-tiny-foursquare"></i> '+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.FOURSQUARE"},data:i}))+"\n					</a>\n\n"},100:function(e,t,n,r,i){return'<a href="#" class="edit-location" data-action="editLocation"></a>'},102:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.mostSpecificWoeId:t,{name:"if",hash:{},fn:e.program(103,i,0),inverse:e.program(108,i,0),data:i}))!=null?s:""},103:function(e,t,n,r,i){var s,o=t!=null?t:{};return((s=n["if"].call(o,t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(104,i,0),inverse:e.program(106,i,0),data:i}))!=null?s:"")+"\n						"+((s=n["if"].call(o,t!=null?t.showEditLocation:t,{name:"if",hash:{},fn:e.program(100,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},104:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'							<a class="location-name-link" data-woe-id="'+f((s=(s=n.mostSpecificWoeId||(t!=null?t.mostSpecificWoeId:t))!=null?s:u,typeof s===a?s.call(o,{name:"mostSpecificWoeId",hash:{},data:i}):s))+'" href="/search/?woe_id='+f((s=(s=n.mostSpecificWoeId||(t!=null?t.mostSpecificWoeId:t))!=null?s:u,typeof s===a?s.call(o,{name:"mostSpecificWoeId",hash:{},data:i}):s))+'">\n				   				'+f((s=(s=n.locationText||(t!=null?t.locationText:t))!=null?s:u,typeof s===a?s.call(o,{name:"locationText",hash:{},data:i}):s))+"\n							</a>\n"},106:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'							<a class="location-name-link" href="/search/?woe_id='+f((s=(s=n.mostSpecificWoeId||(t!=null?t.mostSpecificWoeId:t))!=null?s:u,typeof s===a?s.call(o,{name:"mostSpecificWoeId",hash:{},data:i}):s))+'">\n				   				'+f((s=(s=n.locationText||(t!=null?t.locationText:t))!=null?s:u,typeof s===a?s.call(o,{name:"locationText",hash:{},data:i}):s))+"\n							</a>\n"},108:function(e,t,n,r,i){var s,o,u=t!=null?t:{};return"						"+e.escapeExpression((o=(o=n.locationText||(t!=null?t.locationText:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(u,{name:"locationText",hash:{},data:i}):o))+"\n						"+((s=n["if"].call(u,t!=null?t.showEditLocation:t,{name:"if",hash:{},fn:e.program(109,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},109:function(e,t,n,r,i){return'<a href="#" class="location-name-link edit-location" data-action="editLocation"></a>'},111:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.location:t)!=null?s.staticMaps:s,{name:"if",hash:{},fn:e.program(112,i,0),inverse:e.noop,data:i}))!=null?s:""},112:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s,{name:"if",hash:{},fn:e.program(113,i,0),inverse:e.noop,data:i}))!=null?s:""},113:function(e,t,n,r,i){var s,o=e.lambda,u=e.escapeExpression;return'							<div class="map-container">\n								<span class="static-maps">\n									<span class="bullseye"></span>\n									<span class="zoom zoom3" style="background-image: url('+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.src:s,t))+") 1x, url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom3:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n									<span class="zoom zoom6" style="background-image: url('+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.src:s,t))+") 1x, url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom6:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n									<span class="zoom zoom14" style="background-image: url('+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.src:s,t))+");background-image:-webkit-image-set(url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.src:s,t))+") 1x, url("+u(o((s=(s=(s=t!=null?t.location:t)!=null?s.staticMaps:s)!=null?s.zoom14:s)!=null?s.retinaSrc:s,t))+') 2x);"></span>\n								</span>\n							</div>\n'
},115:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showEditLocation:t,{name:"if",hash:{},fn:e.program(116,i,0),inverse:e.noop,data:i}))!=null?s:""},116:function(e,t,n,r,i){return'					<li class="c-charm-item-location">\n			<span class="empty">\n				<span class="empty-map"></span>\n\n				<a href="#" class="add-location">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADD_PHOTO_TO_MAP"},data:i}))+"</a>\n\n			</span>\n					</li>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i,s,o){var u,a=t!=null?t:{};return'<div class="ui-menu c-charm-list exif-charm-list">\n	<ul>\n		<div class="exif-column-1">\n			<!-- camera -->\n'+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.camera:u,{name:"if",hash:{},fn:e.program(1,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n				<!-- exifs -->\n\n"+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.fNumber:u,{name:"if",hash:{},fn:e.program(13,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.focalLength:u,{name:"if",hash:{},fn:e.program(18,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.exposureTime:u,{name:"if",hash:{},fn:e.program(23,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.iso:u,{name:"if",hash:{},fn:e.program(28,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"+((u=n["if"].call(a,(u=t!=null?t.exif:t)!=null?u.flash:u,{name:"if",hash:{},fn:e.program(33,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"\n"+((u=n.unless.call(a,t!=null?t.isMobileExif:t,{name:"unless",hash:{},fn:e.program(64,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+"		</div>\n\n"+((u=n["if"].call(a,t!=null?t.isMobileExif:t,{name:"if",hash:{},fn:e.program(80,i,0,s,o),inverse:e.noop,data:i}))!=null?u:"")+'\n	<div class="exif-column-2">\n		<!-- Location Data -->\n'+((u=n["if"].call(a,(u=t!=null?t.location:t)!=null?u.text:u,{name:"if",hash:{},fn:e.program(88,i,0,s,o),inverse:e.program(115,i,0,s,o),data:i}))!=null?u:"")+'	</div>\n	<div style="clear: both;"></div>\n	</ul>\n\n</div>\n'},useData:!0,useDepths:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-charm-exif-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-charm-exif-scrappy-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.isMobileExif=e.isMobileExif||!1,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this,r=[];return r.push(t.appContext.getModel("person-relationship-models",t.nsid).then(function(e){t.set("ownerRelationship",e)})),this.appContext.getViewer().signedIn&&r.push(t.appContext.getModel("person-models",t.appContext.getViewer().nsid).then(function(e){t.set("person",e)})),r.push((new e.FlickrPromise({location:t.appContext.getModel("photo-location-models",t.photoId),photo:t.appContext.getModel("photo-models",t.photoId),relationship:t.appContext.getModel("person-relationship-models",t.nsid),stats:t.appContext.getModel("photo-stats-models",t.photoId)})).then(function(e){t.set("location",e.location),t.set("photo",e.photo),t.set("relationship",e.relationship),t.set("stats",e.stats)})),r.push(t.appContext.getModel("photo-exif-models",t.photoId).then(function(n){var r=n.toJSON();t.set("exif",n),t.set("extendedExif",t.getExtendedExif()),t.set("cameraData",e.ExifCameraMap.getCameraImageURL(r.camera,r.cameraType,t.appContext))},function(e){n.warn("Exif failed to load for this photo",{err:e})})),e.Promise.all(r)},buildContainer:function(){var t,n=this.get("photo"),r=this.get("relationship")?this.get("relationship").getValue("isMe"):!1,i=this.get("exif")?this.get("exif").toJSON():null,s=!1,o=!1,u,a=this.get("location")?this.get("location").getValue("mostSpecificWoeId"):null,f=!1,l,c="",h=!1,p="",d="",v=this.get("stats");return typeof this.getViewDataFromHistory("showExpanded")!="undefined"&&this.getViewDataFromHistory("showExpanded")===!0&&(h=!0),i&&(i.metering||i.exposureProgram||i.flash||i.iso||i.exposureTime||i.focalLength||i.fNumber)&&(s=!0),this.get("location")&&(this.get("location").getValue("levels").venue?(this.get("location").getValue("levels").venue.source==="foursquare"?o=!0:o=!1,u=this.get("location").getValue("levels").venue.venueId,l=e.url("/map/?fLat="+this.get("location").getValue("levels").venue.venueLat+"&fLon="+this.get("location").getValue("levels").venue.venueLong+"&zl=13&everyone_nearby=1")):this.get("location").getValue("latitude")&&(l=e.url("/map/?fLat="+this.get("location").getValue("latitude")+"&fLon="+this.get("location").getValue("longitude")+"&zl=13&everyone_nearby=1")),this.get("location").getValue("text")&&(p=this.get("location").getValue("text").replace(/<\/?[^>]+>/g,""))),r&&!this.isMobileExif&&(f=!0),this.get("cameraData")&&(c=this.get("cameraData").url),i&&(this.isMobileExif?i.flashFired||i.flash==="Fired"?d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_SIMPLE_ON"}):d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_SIMPLE_OFF"}):(i.flashModeAuto&&(i.flashFired?d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_AUTO_FIRED"}):d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_AUTO_NO_FIRE"})),i.flashModeOn&&(i.flashFired?d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_ON_FIRED"}):d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_ON_NO_FIRE"})),i.flashModeOff&&(d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_OFF"})),i.flash==="Fired"&&(d=this.intlMessage({intlName:"photo-page-scrappy.FLASH_ON_FIRED"})))),t={exif:i,cameraData:c,location:this.get("location")?this.get("location").toJSON():{},locationText:p,isFoursquare:o,fourSquarePlaceId:u,isOwner:r,isVideo:n?n.getValue("isVideo"):!1,exifInfoIsPresent:s,mostSpecificWoeId:a,stats:this.get("stats")?this.get("stats").toJSON():{},showEditLocation:f,linkToMap:l,showExpanded:h,extendedExif:this.get("extendedExif"),flashString:d,isMobileExif:this.isMobileExif,dateTaken:v.getDateObj("dateTaken"),datePosted:v.getDateObj("datePosted"),takenGranularity:v.getValue("takenGranularity"),isDateTakenUnknown:v.getValue("isDateTakenUnknown")},this.setContainerWithTemplate("photo-charm-exif-scrappy",t),this},activate:function(){var t=this,n=this.get("stats"),r=this.get("container");return n&&this.registerEventHandler(n.on("valuesChanged",function(e){(e.dateTaken||e.datePosted||e.isCirca||e.isSometime||e.takenGranularity)&&t.buildContainer()})),this.registerEventHandler(this.get("container").on("click",this.handleContainerClick.bind(this))),r.one(".exif-column-1").get("children").size()===0&&r.one(".exif-column-2").get("children").size()===0&&(r.setStyle("display","none"),e.one(".sub-photo-right-row1").setStyle("borderBottom","none")),this.isMobileExif&&this.registerEventHandler(this.get("container").delegate("click",function(n){if(n.target){var r=n.target.getAttribute("data-woe-id");r&&(n.halt(),e.use("mobile-actions-helper",function(e){e.MobileActionsHelper.redirectToAppOrStore({os:t.appContext.getUA().os,isWebview:t.appContext.getUA().isWebview,pageURL:"/search/?woe_id="+r,beacon:{name:"mpp_location_click",section:"exif-view"},viewName:t.name})}))}},".location-name-link")),this},getExtendedExif:function(){var t=this.get("exif")?this.get("exif").toJSON():{},n=e.clone(t.data),r=[];return n.forEach(function(e){if(e.value!==null){if(e.label==="Resolution Unit"||e.label==="Aperture"||e.label==="Exposure"||e.label==="Lens"||e.label==="Camera URL"||e.label==="Focal Length"||e.label==="ISOSetting"||e.label==="Flash"||e.label==="Exposure Program"||e.label==="Model")return;if(e.label==="X-Resolution"||e.label==="Y-Resolution")e.value=e.value+" dpi";e.label==="Exposure Bias"&&(e.value=e.value+" EV"),r.push({label:e.label,value:e.value})}}),r},showMoreExif:function(){var e=this.get("container");e.one(".show-extended-exif").setHTML(this.intlMessage({intlName:"photo-page-scrappy.HIDE_EXIF"})),e.one(".show-extended-exif").addClass("hide-moreExif"),e.all(".extended-exif-item").show(),this.setViewDataOnHistory("showExpanded",!0)},hideMoreExif:function(){var e=this.get("container");e.one(".show-extended-exif").setHTML(this.intlMessage(
{intlName:"photo-page-scrappy.SHOW_EXIF"})),e.one(".show-extended-exif").removeClass("hide-moreExif"),e.all(".extended-exif-item").hide(),this.setViewDataOnHistory("showExpanded",!1)},handleLocationClick:function(){if(this.appContext.flipper.isFlipped("geotag-on-photo-page"))e.use(["fluid-modal-view","photo-geotag-modal-view"],function(){var t=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,showCancelButton:!0,showCancelX:!1,title:"",actionButtonLabel:this.intlMessage({intlName:"photo-page-scrappy.SAVE_LOCATION"}),width:640,height:340,fullWindow:!0,subview:new e.Views["photo-geotag-modal-view"]({appContext:this.appContext,photoId:this.get("photo").getValue("id"),locationId:this.get("location").getValue("id")})}),n=this,r=n.get("container").one(".map-container")||n.get("container").one(".empty-map");t.show(),this.registerEventHandler(t.on("actionClick",function(e){var t=this.templates("flickr-balls")({});r.append(t),n.appContext.getModelRegistry("photo-location-models").then(function(e){return e.remove(n.photoId),n.appContext.getModel("photo-location-models",n.photoId)}).then(function(e){n.set("location",e),n.buildContainer()}).catch(function(e){r.remove(t)})}))}.bind(this));else{var t=this.get("photo"),n=t.getValue("id"),r="/photos/organize/?batch_geotag=1&ids="+n+"&from_geo_ids="+n;e.config.win.location=r}},handleError:function(e){return function(e){}},showDateEditor:function(){var t,n;t=new e.Views["date-modify-dialog-view"]({photoID:this.photoId,dateTaken:this.get("stats").getDateObj("dateTaken"),datePosted:this.get("stats").getDateObj("datePosted"),earliestPosted:this.get("person").getValue("dateCreated")}),n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,classList:"scrappy-dialog",width:800,showHeader:!1,showFooter:!1,showButtons:!1,showCancelButton:!1,showCancelX:!1,subview:t}),n.show()},handleContainerClick:function(e){e.target.ancestor(".show-extended-exif",!0)?(e.preventDefault(),e.target.hasClass("hide-moreExif")?this.hideMoreExif():this.showMoreExif()):e.target.ancestor(".edit-date-taken",!0)?(e.preventDefault(),this.showDateEditor()):e.target.ancestor(".c-charm-item-location .add-location, .c-charm-item-location .edit-location",!0)&&(e.preventDefault(),this.handleLocationClick())}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","dropdown","exif-camera-map","hermes-template-photo-charm-exif-scrappy","hermes-template-flickr-balls","url"],optional:["photo-stats-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-sub-photo-right-stats",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" small-text"},3:function(e,t,n,r,i){return" super-small-text"},5:function(e,t,n,r,i){return'		<span class="view-count-label">-</span>\n'},7:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.viewCount:s,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i}))!=null?s:""},8:function(e,t,n,r,i){var s;return'			<span class="view-count-label">\n				'+e.escapeExpression((n.friendlyNumber||t&&t.friendlyNumber||n.helperMissing).call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.viewCount:s,{name:"friendlyNumber",hash:{},data:i}))+"</span>\n"},10:function(e,t,n,r,i){var s;return'			<span class="view-count-label">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isMobileStats:t,{name:"if",hash:{},fn:e.program(11,i,0),inverse:e.noop,data:i}))!=null?s:"")+"			0</span>\n"},11:function(e,t,n,r,i){return'					<svg class="icon icon-view"><use xlink:href="#icon-view"></use></svg>\n'},13:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SINGULAR_VIEW"},data:i}))},15:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.PLURAL_VIEW"},data:i}))},17:function(e,t,n,r,i){return'		<span class="fave-count-label">-</span>\n'},19:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.faveCount:s,{name:"if",hash:{},fn:e.program(20,i,0),inverse:e.program(22,i,0),data:i}))!=null?s:""},20:function(e,t,n,r,i){var s;return'			<span class="fave-count-label">\n				'+e.escapeExpression((n.friendlyNumber||t&&t.friendlyNumber||n.helperMissing).call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.faveCount:s,{name:"friendlyNumber",hash:{},data:i}))+"\n			</span>\n"},22:function(e,t,n,r,i){return'			<span class="fave-count-label">\n				0\n			</span>\n'},24:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SINGULAR_FAVE"},data:i}))},26:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.PLURAL_FAVE"},data:i}))},28:function(e,t,n,r,i){return'		<span class="comment-count-label">-</span>\n'},30:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.commentCount:s,{name:"if",hash:{},fn:e.program(31,i,0),inverse:e.program(33,i,0),data:i}))!=null?s:""},31:function(e,t,n,r,i){var s;return'			<span class="comment-count-label">\n			'+e.escapeExpression((n.friendlyNumber||t&&t.friendlyNumber||n.helperMissing).call(t!=null?t:{},(s=t!=null?t.engagement:t)!=null?s.commentCount:s,{name:"friendlyNumber",hash:{},data:i}))+"</span>\n"},33:function(e,t,n,r,i){return'			<span class="comment-count-label">\n			0</span>\n'},35:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SINGULAR_COMMENT"},data:i}))},37:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.PLURAL_COMMENT"},data:i}))},39:function(e,t,n,r,i){return'	<div class="show-more-stats">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_MORE_STATS"},data:i}))+"</div>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u,a=t!=null?t:{},f=n.helperMissing,l='<div class="view-count'+((s=n["if"].call(a,t!=null?t.smallText:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(a,t!=null?t.superSmallText:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(a,t!=null?t.loadingView:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.program(7,i,0),data:i}))!=null?s:"")+'	<span class="stats-label">'+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.viewCount:s,"===",1,{name:"ifCond",hash:{},fn:e.program(13,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.viewCount:s,"!==",1,{name:"ifCond",hash:{},fn:e.program(15,i,0),inverse:e.noop,data:i}))!=null?s:"")+'</span>\n</div>\n\n<div class="fave-count'+((s=n["if"].call(a,t!=null?t.smallText:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(a,t!=null?t.superSmallText:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(a,t!=null?t.loadingView:t,{name:"if",hash:{},fn:e.program(17,i,0),inverse:e.program(19,i,0),data:i}))!=null?s:"")+'	<span class="stats-label">'+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.faveCount:s,"===",1,{name:"ifCond",hash:{},fn:e.program(24,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.faveCount:s,"!==",1,{name:"ifCond",hash:{},fn:e.program(26,i,0),inverse:e.noop,data:i}))!=null?s:"")+'</span>\n</div>\n\n<div class="comment-count'+((s=n["if"].call(a,t!=null?t.smallText:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n["if"].call(a,t!=null?t.superSmallText:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n'+((s=n["if"].call(a,t!=null?t.loadingView:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.program(30,i,0),data:i}))!=null?s:"")+'	<span class="stats-label">'+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.commentCount
:s,"===",1,{name:"ifCond",hash:{},fn:e.program(35,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.ifCond||t&&t.ifCond||f).call(a,(s=t!=null?t.engagement:t)!=null?s.commentCount:s,"!==",1,{name:"ifCond",hash:{},fn:e.program(37,i,0),inverse:e.noop,data:i}))!=null?s:"")+"</span>\n</div>\n\n";return s=(o=(o=n.showMoreStatsLink||(t!=null?t.showMoreStatsLink:t))!=null?o:f,u={name:"showMoreStatsLink",hash:{},fn:e.program(39,i,0),inverse:e.noop,data:i},typeof o=="function"?o.call(a,u):o),n.showMoreStatsLink||(s=n.blockHelperMissing.call(t,s,u)),s!=null&&(l+=s),l},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-right-stats",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-stats-photo",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression,c=e.lambda;return'\n	<div class="photo-stats-basics">\n		<div class="photo-stats-basics-left">\n			<a href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" class="photo-thumbnail" style="background-image: url('+l((o=(o=n.photoUrl||(t!=null?t.photoUrl:t))!=null?o:a,typeof o===f?o.call(u,{name:"photoUrl",hash:{},data:i}):o))+');"></a>\n			<div class="photo-info">\n				<a href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" class="photo-title truncate">'+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+'</a>\n				<div class="photo-posted-date">\n'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||a).call(u,t!=null?t.datePosted:t,false,false,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+'				</div>\n			</div>\n		</div>\n		<div class="photo-stats-basics-right">\n			<div class="view-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.viewCount:s,t))+'</div>\n			<div class="fave-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.faveCount:s,t))+'</div>\n			<div class="comment-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.commentCount:s,t))+'</div>\n		</div>\n	</div>\n\n	<div class="photo-stats-nav">\n		<div class="nav-links">\n			<div class="photo-stats-nav-link selected" data-link="views">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.RECENT_VIEWS"},data:i}))+'</div>\n			<div class="photo-stats-nav-link" data-link="sources">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.SOURCES"},data:i}))+'</div>\n		</div>\n		<div class="photo-stats-nav-extras">\n			<div class="date-picker">'+l((o=(o=n.prettyDateString||(t!=null?t.prettyDateString:t))!=null?o:a,typeof o===f?o.call(u,{name:"prettyDateString",hash:{},data:i}):o))+' <span></span></div>\n		</div>\n	</div>\n\n	<div class="photo-stats-sections" data-showing="views">\n\n		<div class="photo-stats-section" data-section="views">\n			<div class="daily-views-graph">\n			</div>\n		</div>\n\n		<div class="photo-stats-section" data-section="sources">\n\n			<div class="source-breakdown-left'+((s=n.unless.call(u,t!=null?t.hasReferrers:t,{name:"unless",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				<div class="no-sources">\n					'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.NO_SOURCES_TODAY"},data:i}))+'\n				</div>\n\n				<div class="sources-pie-chart pie-chart"></div>\n			</div>\n\n			<div class="source-breakdown-right'+((s=n.unless.call(u,t!=null?t.hasReferrers:t,{name:"unless",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				<div class="sources-breakdown">\n					<div class="sources-breakdown-header">\n						<div>'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.SOURCES"},data:i}))+"</div>\n						<div>"+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.VISITS"},data:i}))+'</div>\n						<div>%</div>\n					</div>\n					<div class="sources-breakdown-list"></div>\n				</div>\n			</div>\n\n		</div>\n\n	</div>\n\n'},2:function(e,t,n,r,i){return"						"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlDate:t!=null?t.intlDate:t,intlName:t!=null?t.intlName:t},data:i}))+"\n"},4:function(e,t,n,r,i){return" no-results"},6:function(e,t,n,r,i){return'\n	<div class="no-stats-available">\n		'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"stats.NO_RECENT_PHOTO_STATS_AVAILABLE"},data:i}))+"\n	</div>\n\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.actuallyHasSomeStats:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(6,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/stats-photo",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("timezone-helper",function(e){"use strict";e.TimezoneHelper=function(t,n,r){r?(this.tz=r,this.dst=!1):(this.tz=t.getViewer().prefs.timezonePref.offset,this.dst=t.getViewer().prefs.timezonePref.dst),this.momentObject=e.moment(n,"X"),this.momentObject.utcOffset(this.tz),this.dst&&this.momentObject.isDST()&&this.momentObject.add(1,"hour")},e.TimezoneHelper.prototype.toFormat=function(e){return this.momentObject.format(e)}},"@VERSION@",{requires:["moment"]});
YUI.add("stats-helper",function(e){"use strict";var t;YUI.Env.isServer?t=require("querystring").stringify:t=function(e){var t=[],n,r,i;for(n in e)if(e.hasOwnProperty(n))if(Array.isArray(e[n]))for(r=0,i=e[n].length;r<i;r++)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n][r]));else t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},e.StatsHelper=function(){},e.StatsHelper.prototype.moveToFrontOfArray=function(e,t){var n=-1;return e.forEach(function(e,r){e===t&&(n=r)}),n>-1&&e.unshift(e.splice(n,1)[0]),e},e.StatsHelper.prototype.moveToEndOfArray=function(e,t){var n=-1;return e.forEach(function(e,r){e===t&&(n=r)}),n>-1&&(e.push(e[n]),e.splice(n,1)),e},e.StatsHelper.prototype.whichChild=function(e){var t=0;while((e=e.previousElementSibling)!==null)++t;return t},e.StatsHelper.prototype.getRoundedRectanglePath=function(e,t,n,r,i,s,o){var u=e[0],a=e[1],f=t[0],l=t[1],c;return c="M"+(u+n)+","+a,c+="h"+(f-2*n),i?c+="a"+n+","+n+" 0 0 1 "+n+","+n:(c+="h"+n,c+="v"+n),c+="v"+(l-2*n),o?c+="a"+n+","+n+" 0 0 1 "+ -n+","+n:(c+="v"+n,c+="h"+ -n),c+="h"+(2*n-f),s?c+="a"+n+","+n+" 0 0 1 "+ -n+","+ -n:(c+="h"+ -n,c+="v"+ -n),c+="v"+(2*n-l),r?c+="a"+n+","+n+" 0 0 1 "+n+","+ -n:(c+="v"+ -n,c+="h"+n),c+="z",c},e.StatsHelper.prototype.getIdFromParams=function(e){var n=t(e);return n===""&&(n=1),n},e.StatsHelper.prototype.convertStorageTotalToRealNumber=function(e){var t=e;return e===-1&&(t=-1),t},e.StatsHelper.prototype.convertStorageAmountToRealNumber=function(e){var t,n,r,i=100;return e=parseInt(e,10)||1,t=Math.ceil(Math.log(e)/Math.LN10),n=Math.floor(t/3),r=e/Math.pow(10,n*3),r=Math.floor(r*i)/i,r},e.StatsHelper.prototype.convertNaturalLanguageDateToRealDateTimestamp=function(t,n){var r="",i;i=e.moment();switch(n){case"today":r=i;break;case"yesterday":r=i.subtract(1,"days");break;case"thisweek":case"week":r=i.startOf("week");break;case"lastweek":r=i.subtract(1,"weeks").startOf("week");break;case"twoweeksago":case"theweekbeforethat":r=i.subtract(2,"weeks").startOf("week");break;case"threeweeksago":case"theweekbeforetheweekbeforethat":r=i.subtract(3,"weeks").startOf("week")}return r!==""&&(r=(new e.TimezoneHelper(t,r.format("X"),"00:00")).toFormat("YYYY-MM-DD")),r}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom","moment","timezone-helper"],optional:[]});
YUI.add("flickr-stats-photo-daily-views-fetcher",function(e,t){"use strict";function n(e){var t={id:e.id,photo_id:e.photoId};return t}function r(t,n){var r=t.apiResponse.stats,i=r.graphdata,s=t.modelRegistry,o,u={},a={},f=[],l,c,h,p,d;return d={views:0,favs:0,comments:0},o={id:n.id},i&&(u=i,f=Object.keys(i),f.forEach(function(e,t){!u[e].burp&&!u[e].nodot?(c?(c>e&&(c=e),p<e&&(p=e)):(c=e,p=e),u[e].views||(u[e].views=0),u[e].comments||(u[e].comments=0),u[e].favs||(u[e].favs=0),u[e].views=parseInt(u[e].views,10),u[e].favs=parseInt(u[e].favs,10),u[e].comments=parseInt(u[e].comments,10),d.views+=u[e].views,d.favs+=u[e].favs,d.comments+=u[e].comments):delete u[e]})),o.days=u,o.oldestDate=c,o.newestDate=p,o.totals=d,s.exists(o.id)?(a=s.getValue("days"),o.days=e.merge(o.days,a),l=s.getValue("oldestDate"),c>l&&(o.oldestDate=l),h=s.getValue("newestDate"),p>h&&(o.newestDate=h),o.totals+=e.merge(o.totals,s.getValue("totals")),s.setValues(o.id,o)):s.add(o),o}function i(n,r){var i=this;return(new e.FlickrPromise({apiResponse:r.callAPI("flickr.stats.photo.getGraphData",this._processParams(n)),modelRegistry:r.getModelRegistry("stats-photo-daily-views-models")})).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-stats-photo-daily-views"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["stats-photo-daily-views-models"]});
YUI.add("stats-photo-daily-views-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-stats-photo-daily-views"].run(t,this.appContext)}},attributes:{days:{},oldestDate:{},newestDate:{},totals:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-stats-photo-daily-views-fetcher"]});
YUI.add("flickr-stats-referrer-domains-fetcher",function(e,t){"use strict";function i(e){var t={id:e.id,date:e.date||"",photo_id:e.photoId||""};return t}function s(e,t){var n=e.apiResponse,i=e.modelRegistry,s,o={},u={},a=0,f,l,c=n.stat;s={id:t.id},delete n.stat,l=Object.keys(n),n.stat=c;if(l.length===0)throw f=new Error("[flickr-stats-referrer-domains-fetcher] api returned ok but did not contain the data needed"),f.fatal=!0,f;return l.forEach(function(e,t){var i=r[e.toLowerCase()],s,f=n[e];i||(i="other"),o[i]||(o[i]={}),u[i]||(u[i]=0),s=f.viewcount,delete f.viewcount,o[i]=f,u[i]+=s,a+=s}),s.referrers=o,s.totals=u,s.total=a,i.addOrUpdate(s),s}function o(t,r){var i=this;return(new e.FlickrPromise({apiResponse:r.callAPI("flickr.stats.getReferrerCategoriesForDate",this._processParams(t)),modelRegistry:r.getModelRegistry("stats-referrer-domains-models")})).then(function(e){return i._processResponse(e,t)},function(e){if(e.code===2)return n.error({err:e,id:t.id,date:t.date}),r.getModelRegistry("stats-referrer-domains-models").then(function(e){e.addOrUpdate({id:t.id,missingData:!0})});throw e})}var n=require("lib/flog")(t),r={flickr:"flickr","search engine":"search",social:"social",yahoo:"search",google:"search",bing:"search",twitter:"social",facebook:"social",pinterest:"social",tumblr:"social","flickr embedr":"flickr embedr"};e.namespace("ModelFetchers")["flickr-stats-referrer-domains"]={run:o,_processResponse:s,_processParams:i}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["stats-referrer-domains-models"]});
YUI.add("stats-referrer-domains-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-stats-referrer-domains"].run(t,this.appContext)}},attributes:{referrers:{defaultValue:{}},totals:{defaultValue:{}},total:{defaultValue:0},missingData:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-stats-referrer-domains-fetcher"]});
YUI.add("stats-photo-view",function(e){var t=500;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.statsHelper=new e.StatsHelper,this.photoId=t.photoId,this.dateString=t.dateString,this.prettyDateString=t.prettyDateString||t.dateString,this.realtimeDateString=t.realtimeDateString||t.dateString,this.isOwner=t.isOwner,this.nsid=t.nsid,this.isPro=!1,this.pickers={},this.tooltip,this.dateIntl={previousMonth:this.intlMessage({intlName:"pika-day.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pika-day.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pika-day.SUNDAY"}),this.intlMessage({intlName:"pika-day.MONDAY"}),this.intlMessage({intlName:"pika-day.TUESDAY"}),this.intlMessage({intlName:"pika-day.WEDNESDAY"}),this.intlMessage({intlName:"pika-day.THURSDAY"}),this.intlMessage({intlName:"pika-day.FRIDAY"}),this.intlMessage({intlName:"pika-day.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pika-day.SUNDAY_SHORT"}),this.intlMessage({intlName:"pika-day.MONDAY_SHORT"}),this.intlMessage({intlName:"pika-day.TUESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.THURSDAY_SHORT"}),this.intlMessage({intlName:"pika-day.FRIDAY_SHORT"}),this.intlMessage({intlName:"pika-day.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pika-day.JANUARY"}),this.intlMessage({intlName:"pika-day.FEBRUARY"}),this.intlMessage({intlName:"pika-day.MARCH"}),this.intlMessage({intlName:"pika-day.APRIL"}),this.intlMessage({intlName:"pika-day.MAY"}),this.intlMessage({intlName:"pika-day.JUNE"}),this.intlMessage({intlName:"pika-day.JULY"}),this.intlMessage({intlName:"pika-day.AUGUST"}),this.intlMessage({intlName:"pika-day.SEPTEMBER"}),this.intlMessage({intlName:"pika-day.OCTOBER"}),this.intlMessage({intlName:"pika-day.NOVEMBER"}),this.intlMessage({intlName:"pika-day.DECEMBER"})],this.viewClass="",this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="balls"></div>'),this},loadState:function(){if(!this.appContext.flipper.isFlipped("rebootify-stats")||!this.isOwner)return e.Promise.resolve();var t=this,n,r,i,s,o,u,a={};return this.isOwner?this.appContext.getModel("person-models",this.nsid).then(function(f){return t.isPro=f.getValue("isPro"),t.isPro?(n=e.moment().format("X"),r=new e.TimezoneHelper(t.appContext,n,"00:00"),t.dateString||(t.dateString=r.toFormat("YYYY-MM-DD"),t.prettyDateString=r.toFormat("MMM D, YYYY"),t.realtimeDateString=t.dateString),i={date:t.dateString,photoId:t.photoId},s={id:t.statsHelper.getIdFromParams(i)},a.dailyViewsModel=t.appContext.getModel("stats-photo-daily-views-models",s,i),o={date:t.dateString,photoId:t.photoId},u={id:t.statsHelper.getIdFromParams(o)},a.referrerDomainsModel=t.appContext.getModel("stats-referrer-domains-models",u,o),a.photoModel=t.appContext.getModel("photo-models",t.photoId),a.photoStatsModel=t.appContext.getModel("photo-stats-models",t.photoId),(new e.FlickrPromise(a)).then(function(e){t.dailyViewsModel=e.dailyViewsModel,t.referrerDomainsModel=e.referrerDomainsModel,t.photoModel=e.photoModel,t.photoModel.stats=e.photoStatsModel},function(e){console.log(e)})):e.Promise.resolve()}):e.Promise.resolve()},loadNewDateData:function(t){var n=this,r={},i,s;return s={date:t,photoId:n.photoId},i={id:this.statsHelper.getIdFromParams(s)},r.referrerDomainsModel=this.appContext.getModel("stats-referrer-domains-models",i,s),(new e.FlickrPromise(r)).then(function(e){t===n.dateString&&(n.referrerDomainsModel=e.referrerDomainsModel,n.refreshContent())},function(e){console.log(e)})},refreshContent:function(){var e,n=t,r=this.get("container");this.updateCurrentDatePoint(this.dateString,document.querySelector("circle.selectedPoint").getAttribute("key")),this.createReferrersGraphs(),e=r.one(".source-breakdown-right .sources-breakdown"),e&&(n=e.get("clientHeight")),r.setStyles({height:Math.max(t,n+60)+"px"})},buildContainer:function(){var e=!1;return this.isPro&&this.appContext.flipper.isFlipped("rebootify-stats")&&this.isOwner&&(e=this.referrerDomainsModel.getValue("total")>0?!0:!1),this.setContainerWithTemplate("stats-photo",{hasStats:this.isPro,hasReferrers:e,prettyDateString:this.dateString===this.realtimeDateString?this.intlMessage({intlName:"stats.TODAY"}):this.prettyDateString,photoUrl:this.photoModel.getSizeToFit({width:100,height:100}).url,url:this.photoModel.getValue("url"),title:this.photoModel.getValue("title"),basicStats:this.photoModel.getValue("engagement").toJSON(),datePosted:this.photoModel.stats.getDateObj("datePosted"),actuallyHasSomeStats:this.dailyViewsModel&&this.dailyViewsModel.getValue("totals").views>0&&this.isPro}),this},activate:function(){if(!this.appContext.flipper.isFlipped("rebootify-stats")||!this.isOwner||!this.isPro||!this.dailyViewsModel)return this;var t=this,n=this.get("container"),r={},i=n.all(".date-picker").getDOMNodes(),s=this.dailyViewsModel.getValue("oldestDate"),o=this.dailyViewsModel.getValue("newestDate"),u=this.dailyViewsModel.getValue("totals");return u.views>0&&this.isPro&&e.use("d3",function(){n.addClass("hasStats"),t.viewClass="."+n.getAttribute("class").replace(/\s/g,"."),t.createMainGraph(),r={i18n:t.dateIntl,position:"bottom right",reposition:!1,format:"YYYY-MM-DD",minDate:e.moment(s).toDate(),maxDate:e.moment(o).toDate(),yearRange:[parseInt(s.substring(0,4),10),parseInt(o.substring(0,4),10)],defaultDate:e.moment(t.dateString).toDate(),setDefaultDate:!0,onSelect:function(e){t.pickaNewDate(e,this.config().theme)},onOpen:function(){t.el&&(t.el.className+=" stats-photo")}},e.use("pika-day",function(e){i.forEach(function(n,i){t.pickers[i]=new e.Pikaday(e.merge(r,{field:n,theme:"picker-"+i}))})}),t.createReferrersGraphs(),t.registerEventHandler(n.all(".photo-stats-nav-link").on("click",t.handleNavItemClick,t)),t.registerEventHandler(n.one(".source-breakdown-left").on("click",t.handleSourceBreakdownClick,t)),t.registerEventHandler(n.one(".source-breakdown-right"
).on("click",t.handleSourceBreakdownClick,t)),t.registerEventHandler(n.one(".source-breakdown-right").on("mouseover",t.handleSourceBreakdownListItemMouseover,t)),t.registerEventHandler(n.one(".source-breakdown-right").on("mouseout",t.handleSourceBreakdownListItemMouseout,t))}),this},handleNavItemClick:function(n){var r=n.target,i=r.getData("link"),s=this.get("container"),o,u=t,a=!1;r.hasClass("selected")||(s.all(".photo-stats-nav-link").removeClass("selected"),r.addClass("selected"),s.one(".photo-stats-sections").getDOMNode().setAttribute("data-showing",i),i==="sources"?(o=s.one(".source-breakdown-right .sources-breakdown"),o&&(u=o.get("clientHeight"),a=e.config.win.innerWidth<=700,a&&(u=u+140+100+70-60)),s.setStyles({height:Math.max(t,u+60)+"px"})):s.setStyles({height:t+"px"}))},handleSourceBreakdownClick:function(n){var r=n.target,i=r.ancestor(),s=r.getDOMNode(),o=r.getData(),u,a,f=this.get("container"),l,c,h,p,d=".sources-pie-chart",v=f.one(d),m=f.one(".source-breakdown-right"),g,y,b=t,w,E=!1,S,x;if(s.tagName.toLowerCase()==="path")S=this.statsHelper.whichChild(s),i.getDOMNode().classList[0]==="overall"?x=m.all(".referrer-row"):x=m.all(".referrer-row-breakdown-row"),i.getAttribute("referrerkey")!=="other"&&i.getAttribute("referrerkey")!=="flickr embedr"&&x.getDOMNodes()[S].querySelector(".header").click();else if(r.hasClass("header")){o=i.getData(),g={margin:{top:0,right:0,bottom:0,left:0}},g.width=v.get("clientWidth")-g.margin.left-g.margin.right,g.height=v.get("clientHeight")-g.margin.top-g.margin.bottom,l=this.referrerDomainsModel,c=l.getValue("referrers"),h=l.getValue("totals"),p=Object.keys(h),this.statsHelper.moveToFrontOfArray(p,"flickr"),f.all(".referrer-row-breakdown-row-breakdown-row.shown").replaceClass("shown","not-shown"),f.all(".referrer-row-breakdown-row-breakdown .show-whole-list").removeClass("no-show");if(o.category){y=m.getData("showing"),u=o.category,m.all(".referrer-row").removeClass("selected");if(e.AttributeHelpers.coerceBoolean(o.isempty)){y!=="NOPE"&&this.createOverallPieChart(g,p,h,null,null,!1),e.d3.selectAll(this.viewClass+" .sources-pie-chart .first-level").remove(),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.all(".referrer-row-breakdown-row").removeClass("selected"),m.setData("showing","NOPE"),m.setData("subshowing","NOPE");return}y!==u?(i.addClass("selected"),m.setData("showing",u),f.one(".first-level")&&(e.d3.selectAll(this.viewClass+" .sources-pie-chart .first-level").remove(),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.all(".referrer-row-breakdown-row").removeClass("selected"),m.setData("subshowing","NOPE")),this.createOverallPieChart(g,p,h,!0),u==="other"||u==="flickr embedr"?this.createPieChart("first-level",g,Object.keys(c[u].items),c[u].items,u):this.createPieChart("first-level",g,Object.keys(c[u]),c[u],u)):(m.setData("showing","NOPE"),this.createOverallPieChart(g,p,h,null,null,!1),u==="other"||u==="flickr embedr"?this.createPieChart("first-level",g,Object.keys(c[u].items),c[u].items,u,null,!0):this.createPieChart("first-level",g,Object.keys(c[u]),c[u],u,null,!0),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.setData("subshowing","NOPE"))}else if(o.referrer){y=m.getData("subshowing"),u=o.referrer,a=o.parentcategory,m.all(".referrer-row-breakdown-row").removeClass("selected");if(e.AttributeHelpers.coerceBoolean(o.isempty)){m.setData("subshowing","NOPE"),y!=="NOPE"&&(this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeOpen"),this.createPieChart("second-level",g,Object.keys(c[a][y].items),c[a][y].items,y,a,!0));return}y!==u?(i.addClass("selected"),m.setData("subshowing",u),f.one(".first-level")&&e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeClose"),this.createPieChart("second-level",g,Object.keys(c[a][u].items),c[a][u].items,u,a)):(m.setData("subshowing","NOPE"),this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeOpen"),this.createPieChart("second-level",g,Object.keys(c[a][u].items),c[a][u].items,u,a,!0))}w=f.one(".source-breakdown-right .sources-breakdown"),b=w.get("clientHeight"),E=e.config.win.innerWidth<=700,E&&(b=b+140+100+70-60),f.setStyles({height:Math.max(t,b+60)+"px"})}else r.hasClass("show-whole-list")&&(f.all(".referrer-row-breakdown-row-breakdown-row.not-shown").replaceClass("not-shown","shown"),f.all(".referrer-row-breakdown-row-breakdown .show-whole-list").addClass("no-show"))},handleSourceBreakdownListItemMouseover:function(e){var t=e.target,n=t.ancestor(),r=this.get("container"),i,s;n.hasClass("referrer-row")?(i=this.statsHelper.whichChild(n.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .overall path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class","")):n.hasClass("referrer-row-breakdown-row")?(i=this.statsHelper.whichChild(n.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .first-level path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class","")):t.hasClass("referrer-row-breakdown-row-breakdown-row")&&(i=this.statsHelper.whichChild(t.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .second-level path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class",""))},handleSourceBreakdownListItemMouseout:function(e){var t=e.target;t.getDOMNode().getAttribute("class")!=="pie"&&t.getDOMNode().tagName!=="path"&&this.get("container").all(".source-breakdown-left .pie-chart path").setAttribute("class","")},pickaNewDate:function(t,n){var r=new e.TimezoneHelper(this.appContext,t.getTime()/1e3+Math.abs(t.getTimezoneOffset()*60),"00:00"),i,s;this.dateString=r.toFormat("YYYY-MM-DD"),this.prettyDateString=r.toFormat("MMM D, YYYY");for(i in this.pickers)this.dateString===this.realtimeDateString?s=this.intlMessage({intlName:"stats.TODAY"}):s=this.prettyDateString,s+=" <span></span>",this.pickers
[i]._o.field.innerHTML=s,i!==n&&this.pickers[i].setMoment(r.momentObject,!0);this.loadNewDateData(this.dateString)},createMainGraph:function(){function b(t){t.each(function(){var t=e.d3.select(this),n=t.text().split(/\s+/).reverse(),r,i=[],s=0,o=1.1,u=t.attr("y"),a=parseFloat(t.attr("dy")),f=t.text(null).append("tspan").attr("x",0).attr("y",u).attr("dy",a+"em"),l=n.length;while(r=n.pop())i.push(r),f.text(i.join(" ")),l>1&&(i.pop(),f.text(i.join(" ")),i=[r],r!==""&&r!==" "&&(f=t.append("tspan").attr("x",0).attr("y",u).attr("dy",s++*o+a+"em").text(r)))})}var t=this.dailyViewsModel,n=t.getValue("days"),r=Object.keys(n),i=t.getValue("newestDate"),s=e.d3.time.format("%Y-%m-%d").parse,o=this,u=this.get("container"),a=".daily-views-graph",f=u.one(a),l,c,h,p,d,v=[],m,g,y="linear";this.daysKeys=r,h={margin:{top:15,right:15,bottom:90,left:60}},h.width=f.get("clientWidth")-h.margin.left-h.margin.right,h.height=f.get("clientHeight")-h.margin.top-h.margin.bottom,o.createYStuff=function(t){var i={};return i.yMin=0,i.yMax=e.d3.max(r,function(e,r){return+n[e][t]}),i.yMax=Math.ceil(i.yMax*1.2),i.yMaxLength=i.yMax.toString().length,i.yAxisDivisor=Math.pow(10,Math.max(0,i.yMaxLength-2)),i.yMax=Math.ceil(i.yMax*.2/i.yAxisDivisor)*i.yAxisDivisor*5,i.yAxisValues=[0,Math.ceil(i.yMax*.2/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.4/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.6/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.8/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax/i.yAxisDivisor)*i.yAxisDivisor],i.y=e.d3.scale.linear().range([h.height,0]).domain([i.yMin,i.yMax]),i.yAxis=e.d3.svg.axis().scale(i.y).orient("left").tickSubdivide(!1).tickValues(i.yAxisValues).tickFormat(function(e,t){var n=e;return t===0&&(n=""),n}),i},g={views:o.createYStuff("views"),favs:o.createYStuff("favs"),comments:o.createYStuff("comments")},r.forEach(function(e,t){v.push(s(e))}),d=e.d3.extent(r,function(e,t){return s(e)}),p=e.d3.time.scale().range([0,h.width]).domain(d),m=e.d3.svg.axis().scale(p).orient("bottom").tickValues(v).tickFormat(function(t,n){var r="";if(n%2===0){r=parseInt(e.d3.time.format("%e")(t),10);if(n===0||r===1||r===2)r+=" "+e.d3.time.format("%b")(t)}return r}),l=e.d3.select(o.viewClass+" "+a).append("svg").attr("class","main-graph").attr("width",h.width+h.margin.left+h.margin.right).attr("height",h.height+h.margin.top+h.margin.bottom).on("mouseleave",function(){e.d3.select(o.viewClass+" .selectedPoint").attr("cx",-100).attr("cy",-100)}),c=l.append("defs"),c.append("linearGradient").attr("id","photoDailyViewsViews").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data([{offset:"0%",color:"#24d9d7"},{offset:"100%",color:"#00aaff"}]).enter().append("stop").attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color}),l.append("g").attr("class","weekends").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("width",h.width).attr("height",h.height).selectAll("rect").data(r).enter().append("rect").attr("class",function(e,t){var n=s(e),r=n.getDay(),i="";if(r===0||r===6)i="weekend";return i}).attr("y",0).attr("x",function(e,t){var n=p(s(e));return t>0&&(n-=h.width/r.length/2),n}).attr("height",h.height).attr("width",function(e,t){var n=h.width/r.length;if(t===0||t===r.length-1)n/=2;return n}),l.append("g").attr("class","gridlines").attr("transform","translate(0, "+h.margin.top+")").selectAll("line").data(g.views.yAxisValues).enter().append("line").attr("x1",0).attr("x2",h.width+h.margin.left+h.margin.right).attr("y1",function(e){return g.views.y(e)}).attr("y2",function(e){return g.views.y(e)}),o.createYAxis=function(t,n){var r=!1;r=e.d3.selectAll(o.viewClass+" .y.axis"),r&&r.remove(),t.insert("g",".x.axis").attr("class","y axis").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").call(g[n].yAxis).selectAll("text").attr("x","-10").attr("y","12")},o.createYAxis(l,"views"),l.append("g").attr("class","x axis").attr("transform","translate("+h.margin.left+", "+(h.height+h.margin.top)+")").call(m).selectAll("text").attr("y","10").call(b),o.createFlatLine=function(){return e.d3.svg.line().x(function(e){return p(s(e))}).y(function(e){return g.views.y(0)})},o.createLine=function(t){return e.d3.svg.line().interpolate(y).x(function(e){return p(s(e))}).y(function(e){return g[t].y(n[e][t])})},o.createArea=function(t){return e.d3.svg.area().interpolate(y).x(function(e){return p(s(e))}).y0(h.height).y1(function(e){return g[t].y(n[e][t])})},l.append("path").attr("class","main-line views").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("d",o.createFlatLine()(r)).attr("stroke","url(#photoDailyViewsViews)").transition().delay(500).duration(500).attr("d",o.createLine("views")(r)),o.updatePoint=function(t,r,i,u){var a=e.d3.select(o.viewClass+" "+t),f=a.attr("cx"),l=a.attr("cy"),c=p(s(r))+h.margin.left,d=g[i].y(n[r][i])+h.margin.top;return u?a.transition().duration(500).attr("cx",c).attr("cy",d).attr("date",r).attr("key",i):a.attr("cx",c).attr("cy",d).attr("date",r).attr("key",i),{point:a,oldXY:[f,l],newXY:[c,d]}},o.updateCurrentDatePoint=function(e,t,n){o.updatePoint(".currentDatePoint",e,t,n)},o.updateSelectedPoint=function(t,n,r){o.updatePoint(".selectedPoint",t,n,r);var i,s,u={};return i={date:t,photoId:o.photoId},s={id:o.statsHelper.getIdFromParams(i)},u.referrerDomainsModel=this.appContext.getModel("stats-referrer-domains-models",s,i),(new e.FlickrPromise(u)).then(function(e){},function(e){console.log(e)})},o.createVoronoi=function(t){var n=!1;n=e.d3.selectAll(o.viewClass+" g.voronoi"),n&&n.remove(),l.insert("g",".selectedPoint").attr("class","voronoi").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("width",h.width+h.width/r.length).attr("height",h.height).selectAll("rect").data(r).enter().append("rect").attr("y",0).attr("x",function(e,t){var n=p(s(e));return n-=h.width/r.length/2,n}).attr("height",h.height).attr("width",function(e,t){return h.width/r.length}).on("mouseenter",function(
e,n){o.updateSelectedPoint(r[n],t)})},l.append("circle").attr("class","currentDatePoint").attr("date",i).attr("key","views").attr("r",7).attr("cx",function(e,t){var n=0;return i===o.dateString?n=p(s(i))+h.margin.left:n=p(s(o.dateString))+h.margin.left,n}).attr("cy",g.views.y(0)+h.margin.top).transition().delay(500).duration(500).attr("cy",function(e,t){var r=0;return i===o.dateString?r=g.views.y(n[i].views)+h.margin.top:r=g.views.y(n[o.dateString].views)+h.margin.top,r}),l.append("circle").attr("class","selectedPoint").attr("cx",-100).attr("cy",-100).attr("r",4).attr("date",i).attr("key","views").on("click",function(){o.pickaNewDate(new Date(this.getAttribute("date")))}).on("mouseenter",function(t,r){var i=this.getAttribute("date"),s=n[i],a=new Date(i),f=new e.TimezoneHelper(o.appContext,a.getTime()/1e3+Math.abs(a.getTimezoneOffset()*60),"00:00"),l=f.toFormat("MMMM D"),c,h=150,p,d=s.views;s.favs>d&&(d=s.favs),s.comments>d&&(d=s.comments),h+=(d.toString().length-1)*20,p=-(h/2)+3,c='<div class="date">'+l+"</div>"+'<div class="stats">'+'<div class="stat">'+'<i class="icon" data-type="views"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.views})+"</div>"+'<div class="stat">'+'<i class="icon" data-type="faves"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.favs})+"</div>"+'<div class="stat">'+'<i class="icon" data-type="comments"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.comments})+"</div>"+"</div>",o.tooltip?o.tooltip.updateHTMLMessage(c):(o.tooltip=new e.Views.FluidDroparound({appContext:o.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,showDropArrow:!0,preferTop:!0,preferLeft:!0,width:h,height:60,classList:"photo-daily-stats-tooltip over-modal",anchorElement:u.one(".selectedPoint"),hideModalOverlay:!0,invisibleOverlay:!0,htmlMessage:c,anchorOffsetHorizontal:24,anchorOffsetVertical:10,closeOnScroll:!0}),o.tooltip.show())}).on("mouseleave",function(e){o.tooltip&&(o.tooltip.close(),o.tooltip=undefined)}),o.createVoronoi("views")},createReferrersGraphs:function(){var e=this,t=this.referrerDomainsModel,n=t.getValue("referrers"),r,i=t.getValue("total"),s=t.getValue("totals"),o,u=this.get("container"),a=".sources-pie-chart",f=u.one(a),l=u.one(".source-breakdown-left"),c=u.one(".source-breakdown-right"),h=f.one(".overall"),p,d,v="";c.setData("showing","NOPE"),c.setData("subshowing","NOPE"),parseInt(i,10)===0?(l.addClass("no-results"),c.addClass("no-results")):(l.removeClass("no-results"),c.removeClass("no-results"),r=Object.keys(n),this.statsHelper.moveToFrontOfArray(r,"flickr"),this.statsHelper.moveToEndOfArray(r,"other"),o=Object.keys(s),this.statsHelper.moveToFrontOfArray(o,"flickr"),this.statsHelper.moveToEndOfArray(o,"other"),d={margin:{top:0,right:0,bottom:0,left:0}},d.width=f.get("clientWidth")-d.margin.left-d.margin.right,d.height=f.get("clientHeight")-d.margin.top-d.margin.bottom,this.set("outerRadius",d.height/2),h?p=e.createOverallPieChart(d,o,s,!1,!0):p=e.createOverallPieChart(d,o,s),v='<div class="referrer-rows">',o.forEach(function(t,n){t==="search"&&s[t]===0?v+='<div class="referrer-row" data-category="'+t+'" data-isempty="true">':v+='<div class="referrer-row" data-category="'+t+'" data-isempty="false">',v+='<div class="header">',t==="search"&&s[t]===0?v+='<div><span class="dot"></span>'+t+"</div>":v+='<div><span class="dot"></span>'+t+'<span class="caret"></span></div>',v+="<div>"+e.intlMessage({intlName:"stats.NUMBER",num:s[t]})+"</div>",v+="<div>"+Math.round(s[t]/i*100)+"%</div>",v+="</div>",v+="</div>"}),v+="</div>",c.one(".sources-breakdown-list").empty().append(v),r.forEach(function(t,r){var i="",o,u,a;t==="other"||t==="flickr embedr"?(o=n[t].items,u=Object.keys(o),a=s[t],typeof a.viewcount!="undefined"&&(a=a.viewcount),i='<div class="referrer-row-breakdown" data-index="'+r+'" data-group="'+t+'">'+e.createOtherReferrerListRowsHTML(u,o,a,t)+"</div>"):(o=n[t],u=Object.keys(o),a=s[t],i='<div class="referrer-row-breakdown" data-index="'+r+'" data-group="'+t+'">'+e.createReferrerListRowsHTML(u,o,a,t)+"</div>"),c.one('.referrer-row[data-category="'+t+'"]').append(i)}))},createOverallPieChart:function(t,n,r,i,s){i||(i=!1);var o,u,a,f,l=this.get("outerRadius"),c=this.get("innerRadius"),h=501,p=this.get("container"),d=".sources-pie-chart",v=p.one(d).one("svg .overall"),m,g=0;n.forEach(function(e){var t=r[e];typeof t.viewcount!="undefined"&&(t=t.viewcount),g+=t}),m=e.d3.scale.linear().domain([1,n.length]).range(["#00aaff","#18297f"]),u=e.d3.svg.arc().innerRadius(c).outerRadius(l),s&&v&&(e.d3.select(this.viewClass+" "+d+" svg").remove(),v=!1),v?i?(a=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(-2*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d+" svg .overall"),f=o.datum(n).selectAll("path").call(function(t){t.transition().delay(function(e,t){var i=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];i=s/g*h}return i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.startAngle=n(e),u(t)}})})):(a=e.d3.layout.pie().startAngle(2*Math.PI).endAngle(0*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d+" svg .overall"),f=o.selectAll("path"),f.data().map(function(e,t){e.startAngle=e.originalStartAngle,e.endAngle=e.originalEndAngle}),f.call(function(t){t.transition().delay(function(e,t){var i=0,s=0,o=0;for(o=t+1;o<n.length;o++)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];return i=s/g*h,i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.startAngle=n(e),u(t)}})}),e.d3.select(this.viewClass+" "+d+" svg text").text(g)):(a=e.d3.layout.pie().startAngle(0*Math
.PI).endAngle(2*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d).append("svg").attr("class","pie").attr("width",t.width+t.margin.left+t.margin.right).attr("height",t.height+t.margin.top+t.margin.bottom).append("g").attr("class","overall").attr("height",t.height+t.margin.top+t.margin.bottom).attr("width",l*2).attr("transform","translate("+t.width/2+", "+l+")"),f=o.datum(n).selectAll("path").data(a).enter().append("path").attr("data-source",function(e){return e.data}).on("mouseenter",function(e,t){var n=this.get("container"),r,i;r=n.all(".source-breakdown-right .referrer-row"),i=n.all(".source-breakdown-left .pie-chart .overall path"),r.removeClass("temp-selected"),r.getDOMNodes()[t].setAttribute("class",r.getDOMNodes()[t].getAttribute("class")+" temp-selected"),i.setAttribute("class","not-selected"),i.getDOMNodes()[t].setAttribute("class","")}.bind(this)).on("mouseleave",function(e,t){var n=this.get("container"),r,i;r=n.all(".source-breakdown-right .referrer-row"),i=n.all(".source-breakdown-left .pie-chart .overall path"),r.removeClass("temp-selected"),i.setAttribute("class","")}.bind(this)).transition().delay(function(e,t){var i=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];i=s/g*h}return i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),u(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle}),o.append("text").attr("transform","translate(0, 5)").attr("fill-opacity",0).text(g).transition().delay(h/2).duration(h/2).attr("fill-opacity",1))},createPieChart:function(t,n,r,i,s,o,u){u||(u=!1);var a,f,l,c,h=this.get("outerRadius"),p=this.get("innerRadius"),d=501,v=this.get("container"),m=".sources-pie-chart",g=v.one(m).one("svg ."+t),y,b=0,w=r.length;return r.forEach(function(e){var t=i[e];typeof t.viewcount!="undefined"&&(t=t.viewcount),b+=t}),y=e.d3.scale.linear().domain([1,r.length]).range(["#00aaff","#18297f"]),f=e.d3.svg.arc().innerRadius(p).outerRadius(h),g?u===!0?b===0?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){return 1}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,i=0,s=0;for(s=t+1;s<r.length;s++)i+=1;return n=i/w*d,n}).duration(function(e,t){var n=0;return n=e.value/w*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})})):(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;for(o=t+1;o<r.length;o++)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];return n=s/b*d,n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})})):u==="fakeClose"?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(-2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];n=s/b*d}return n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.startAngle=n(e),f(t)}})})):(l=e.d3.layout.pie().startAngle(2*Math.PI).endAngle(0*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.selectAll("path"),c.data().map(function(e,t){e.startAngle=e.originalStartAngle,e.endAngle=e.originalEndAngle}),c.call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;for(o=t+1;o<r.length;o++)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];return n=s/b*d,n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.startAngle=n(e),f(t)}})}),e.d3.select(this.viewClass+" "+m+" svg text").text(b)):(b===0?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){return 1}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg").append("g").attr("class",t).attr("referrerkey",s).attr("parentreferrerkey",o).attr("height",n.height+n.margin.top+n.margin.bottom).attr("width",h*2).attr("transform","translate("+n.width/2+", "+h+")"),c=a.datum(r).selectAll("path").data(l).enter().append("path").attr("data-source",function(e){var t=e.data;if(s==="flickr"||s==="other"||s==="flickr embedr")t="";return t}).attr("fill",function(e,t){var n="";if(s==="flickr"||s==="other"||s==="flickr embedr"||o)n=y(t);return n}).transition().delay(function(e,t){var n=0,r=0,i=0;if(t>0){for(i=t-1;i>=0;--i)r+=1;n=r/w*d}return n}).duration(function(e,t){var n=0;return n=e.value/w*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})):(l=e.d3.layout.pie().startAngle
(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg").append("g").attr("class",t).attr("referrerkey",s).attr("parentreferrerkey",o).attr("height",n.height+n.margin.top+n.margin.bottom).attr("width",h*2).attr("transform","translate("+n.width/2+", "+h+")"),c=a.datum(r).selectAll("path").data(l).enter().append("path").attr("data-source",function(e){var t=e.data;if(s==="flickr"||s==="other"||s==="flickr embedr")t="";return t}).attr("fill",function(e,t){var n="";if(s==="flickr"||s==="other"||s==="flickr embedr"||o)n=y(t);return n}).on("mouseenter",function(e,n){var r=this.get("container"),i,u,a;o?(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown-row[data-parentcategory="'+o+'"][data-referrer="'+s+'"] .referrer-row-breakdown-row-breakdown-row:not(.not-shown)'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path'),i.removeClass("selected"),a=i.getDOMNodes()[n],a&&a.setAttribute("class","referrer-row-breakdown-row-breakdown-row temp-selected")):(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown[data-group="'+s+'"] .referrer-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path'),i.removeClass("selected"),i.getDOMNodes()[n].setAttribute("class","referrer-row-breakdown-row temp-selected")),u.setAttribute("class","not-selected"),u.getDOMNodes()[n].setAttribute("class","")}.bind(this)).on("mouseleave",function(e,n){var r=this.get("container"),i,u;o?(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown-row[data-parentcategory="'+o+'"][data-referrer="'+s+'"] .referrer-row-breakdown-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path')):(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown[data-group="'+s+'"] .referrer-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path')),i.removeClass("temp-selected"),u.setAttribute("class","")}.bind(this)).transition().delay(function(e,t){var n=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];n=s/b*d}return n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})),e.d3.select(this.viewClass+" "+m+" svg text").text(b)),a},createReferrerBreakdownListRowsHTML:function(t,n,r,i){var s=this,o="",u,a,f=5;return u=Object.keys(t),a=e.d3.scale.linear().domain([1,u.length]).range(["#00aaff","#18297f"]),o='<div class="referrer-row-breakdown-row-breakdown">',u.forEach(function(r,i){var u,l,c,h="",p=!1,d=t[r].viewcount;u="referrer-row-breakdown-row-breakdown-row",i>=f&&(u+=" not-shown"),l=e.Escape.html(t[r].displaytext);if(l.toLowerCase()==="direct"||l==="/")t[r].platform&&(l=t[r].platform.split(".")[1]),t[r].link&&t[r].link!==""&&t[r].link!=="/"&&(l=t[r].link);t[r].link&&t[r].link!==""&&t[r].link!=="/"&&(p=!0,c=e.Escape.html(t[r].link)),h=' style="background: '+a(i)+';"',p?o+='<a class="'+u+'" title="'+l+'" href="'+c+'" target="_blank">':o+='<div class="'+u+'" title="'+l+'">',o+='<div><span class="dot"'+h+"></span>"+l+"</div>",o+="<div>"+s.intlMessage({intlName:"stats.NUMBER",num:d})+"</div>",o+="<div>"+Math.round(d/n*100)+"%</div>",p?o+="</a>":o+="</div>"}),u.length>f&&(o+='<div class="show-whole-list">'+s.intlMessage({intlName:"stats.SHOW_ALL"})+"</div>"),o+="</div>",o},createReferrerListRowsHTML:function(t,n,r,i){var s="",o=this,u,a="";return u=e.d3.scale.linear().domain([1,t.length]).range(["#00aaff","#18297f"]),t.forEach(function(e,t){var f=n[e],l=e;l.toLowerCase()==="sets"&&(l="Albums"),typeof f.viewcount!="undefined"&&(f=f.viewcount);if(i==="flickr"||i==="other"||i==="flickr embedr")a=' style="background: '+u(t)+';"';s+='<div class="referrer-row-breakdown-row" title="'+l+'" data-parentcategory="'+i+'" data-referrer="'+e+'" data-isempty="'+!n[e].items+'">',s+='<div class="header">',n[e].items?s+='<div><span class="dot"'+a+"></span>"+l+'<span class="caret"></span></div>':s+='<div><span class="dot"'+a+"></span>"+l+"</div>",s+="<div>"+o.intlMessage({intlName:"stats.NUMBER",num:f})+"</div>",r>0?s+="<div>"+Math.round(f/r*100)+"%</div>":s+="<div>0%</div>",s+="</div>",n[e].items&&(s+=o.createReferrerBreakdownListRowsHTML(n[e].items,f,i,e)),s+="</div>"}),s},createOtherReferrerListRowsHTML:function(t,n,r,i){var s=this,o="",u;return u=e.d3.scale.linear().domain([1,t.length]).range(["#00aaff","#18297f"]),t.forEach(function(t,a){var f,l,c="",h=!1,p=n[t].viewcount;f=e.Escape.html(n[t].displaytext);if(f.toLowerCase()==="direct"||f==="/")n[t].platform&&(f=n[t].platform.split(".")[1]),n[t].link&&n[t].link!==""&&n[t].link!=="/"&&(f=n[t].link);n[t].link&&n[t].link!==""&&n[t].link!=="/"&&(h=!0,l=e.Escape.html(n[t].link)),c=' style="background: '+u(a)+';"',h?o+='<a class="referrer-row-breakdown-row" title="'+f+'" href="'+l+'" target="_blank" data-parentcategory="'+i+'">':o+='<div class="referrer-row-breakdown-row" title="'+f+'" data-parentcategory="'+i+'">',o+='<div class="header">',o+='<div><span class="dot"'+c+"></span>"+f+'<span class="caret"></span></div>',o+="<div>"+s.intlMessage({intlName:"stats.NUMBER",num:p})+"</div>",o+="<div>"+Math.round(p/r*100)+"%</div>",o+="</div>",h?o+="</a>":o+="</div>"}),o},destructor:function(){this.tooltip&&(this.showTooltip=!1,this.tooltip.close(),this.tooltip=undefined)}},{ATTRS:{innerRadius:{value:29},outerRadius:{value:0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-stats-photo","moment","timezone-helper","stats-helper","photo-models","photo-engagement-models","photo-stats-models","stats-photo-daily-views-models","stats-referrer-domains-models"],optional:[],langBundles:["common","stats","pika-day","photo-page-scrappy"
]});
YUI.add("hermes-lang-stats",function(e,t){e.Intl.add("hermes/stats","en-US",{STATS:["Stats"],NUMBER:[{type:"number",valueName:"num"}],NUMBER_VIEWS:[{type:"number",valueName:"num"}," views"],NUMBER_FAVES:[{type:"number",valueName:"num"}," faves"],NUMBER_COMMENTS:[{type:"number",valueName:"num"}," comments"],VIEW_COUNTS:["View Counts"],SO_FAR_TODAY:["So far today"],SO_FAR_TODAY_DOT_DOT_DOT:["So far today..."],YESTERDAY:["Yesterday"],ALL_TIME:["All time"],PHOTOS_AND_VIDEOS:["Photos and Videos"],PHOTOS:["Photos"],VIDEOS:["Videos"],PHOTOSTREAM:["Photostream"],ALBUMS:["Albums"],COLLECTIONS:["Collections"],GALLERIES:["Galleries"],TOTAL:["Total"],TOP_PHOTOS_AND_VIDEOS:["Top photos and videos"],CONTENT_BREAKDOWN:["Content Breakdown <span>(",{type:"number",valueName:"num"}," items)</span>"],VIEWS:["Views"],ALL_TIME_VIEWS:["All Time views"],ALL_TIME_FAVES:["All time faves"],ALL_TIME_COMMENTS:["All time comments"],DATE:["Date"],INTERESTINGNESS:["Interestingness"],FAVORITES:["Favorites"],COMMENTS:["Comments"],RECENT_VIEWS:["Recent views"],RECENT_FAVES:["Recent faves"],RECENT_COMMENTS:["Recent comments"],BACK_TO_STATS:["Back to Stats"],SOURCE_BREAKDOWN:["Source breakdown"],ALL_PHOTO_AND_VIDEOS_LINK:["All photos and videos"],VISITS:["Visits"],PRO_UNTIL_DATE:["PRO until ","${date}"],PRO_SINCE_DATE:["PRO since ","${date}"],PRO_SINCE_MONTHYEAR:["PRO since ",{type:"date",valueName:"intlDate",format:"monthYear"}],PRO_UNTIL_MONTHYEAR:["PRO until ",{type:"date",valueName:"intlDate",format:"monthYear"}],LEARN_MORE:["Learn more"],CURRENT_STATS_DATE:["Stats are shown in GMT, where it's currently ","${time}"," on ","${date}"],CURRENT_STATS_LONGDATE:["Stats are shown in GMT, where it's currently ","${time}"," on ",{type:"date",valueName:"intlDate",format:"long"}],SPACE_USED_LIMITED:["${used}"," of ","${total}"," used"],SPACE_USED_UNLIMITED:["${used}"," of unlimited used"],PUBLIC:["Public"],FRIENDS:["Friends"],FAMILY:["Family"],FF:["Friends and Family"],PRIVATE:["Private"],TAGGED:["Tagged"],GEOTAGGED:["Geotagged"],IN_ALBUMS:["In albums"],IN_GROUPS:["In groups"],VIEWED:["Viewed"],FAVED:["Faved"],COMMENTED:["Commented"],NO_SOURCES_TODAY:["No sources for this day"],NO_VIEWS_TODAY:["No photos have been viewed today"],PERCENTAGE_OF_VIEWS:[{type:"number",valueName:"num"},"% of views"],PERCENTAGE_OF_FAVES:[{type:"number",valueName:"num"},"% of faves"],PERCENTAGE_OF_COMMENTS:[{type:"number",valueName:"num"},"% of comments"],TODAY:["Today"],SOURCES:["Sources"],LOAD_MORE:["Load more"],NEXT:["Next"],PREVIOUS:["Previous"],MEDIA:["Media"],VISIBILITY:["Visibility"],ALPHA_LABEL:["Stats Alpha"],BETA_LABEL:["Stats Beta"],SHOW_ALL:["Show all"],PHOTO_STATS:["Photo stats"],EXPAND_ALL:["Expand all"],COLLAPSE_ALL:["Collapse all"],NO_PHOTO_STATS_AVAILABLE:["No stats available for this photo"],NO_RECENT_PHOTO_STATS_AVAILABLE:["No recent stats available for this photo"],WELCOME_TO_STATS:["Welcome to stats"],WELCOME_MODAL_SCREEN_1:["Easily see your all time data"],WELCOME_MODAL_SCREEN_2:["More powerful navigation"],WELCOME_MODAL_SCREEN_3:["More meaningful data, categories, and social sources"],WELCOME_MODAL_SCREEN_2_QUICK:["Quickly access your data with improved navigation"],WORKING_ON_IT:["We're working on it"],STATS_LOADING:["We're having some trouble displaying stats at the moment. Please try again."]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-pika-day",function(e,t){e.Intl.add("hermes/pika-day","en-US",{DATE_FORMAT:["MM-DD-YYYY"],PREVIOUS_MONTH:["Previous Month"],NEXT_MONTH:["Next Month"],JANUARY:["January"],FEBRUARY:["February"],MARCH:["March"],APRIL:["April"],MAY:["May"],JUNE:["June"],JULY:["July"],AUGUST:["August"],SEPTEMBER:["September"],OCTOBER:["October"],NOVEMBER:["November"],DECEMBER:["December"],SUNDAY:["Sunday"],MONDAY:["Monday"],TUESDAY:["Tuesday"],WEDNESDAY:["Wednesday"],THURSDAY:["Thursday"],FRIDAY:["Friday"],SATURDAY:["Saturday"],SUNDAY_SHORT:["S"],MONDAY_SHORT:["M"],TUESDAY_SHORT:["T"],WEDNESDAY_SHORT:["W"],THURSDAY_SHORT:["T"],FRIDAY_SHORT:["F"],SATURDAY_SHORT:["S"]})},"@VERSION@",{requires:["intl"]});
